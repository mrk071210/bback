webpackJsonp([11,78,82,94],{Fb61:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("aA9S"),o=a.n(r),n=a("uTPb"),i=(a("4+6g"),a("KWYu")),s={orgName:"",orgShortName:"",orgType:"",orgParentName:"",orgParentUuid:"",orgSortIndex:"1",orgEnabled:1,orgDesc:""},l={name:"OrgUpdate",data:function(){return{showDetailMode:!0,isVisible:!1,isFormDisabled:!1,organization:[],orgForm:o()({},s),orgFormRules:{orgName:[{required:!0,message:"请填写机构名称",trigger:"blur"},{max:30,message:"最大长度为30字符",trigger:"blur"}],orgShortName:[{required:!0,message:"请填写机构简称",trigger:"blur"},{validator:n.a.isShortString,message:"请输入一到六位英文字母",trigger:"blur"}],orgType:[{required:!0,message:"请选择机构类型",trigger:"blur"}],orgSortIndex:[{required:!0,message:"请输入顺序号",trigger:"blur"},{validator:n.a.strNumber,trigger:"blur"},{max:3,message:"不能超过3位数字",trigger:"blur"}]}}},props:{show:{type:Boolean,required:!0,default:!1},nodeData:{type:Object,required:!0},isCreate:{type:Boolean,required:!0}},mounted:function(){},watch:{show:function(e){e&&(this.isCreate?this.setToCreateState():this.setToEditState()),this.isVisible=e}},methods:{setToCreateState:function(){this.nodeData?(this.orgForm=o()({},s),this.orgForm.orgParentName=this.nodeData.orgName,this.orgForm.orgParentUuid=this.nodeData.id):(this.$message({message:"未找到父节点,无法在此情况下创建组织结构.",type:"error"}),this.isFormDisabled=!0)},setToEditState:function(){this.nodeData.id;var e=this.nodeData;this.orgForm=o()({},e),this.orgForm.orgShortName=this.nodeData.name,this.orgForm.orgParentName=this.nodeData.pName||this.nodeData.name,this.orgForm.orgParentUuid=this.nodeData.pId,this.orgForm.orgSortIndex=this.nodeData.sortIndex,this.orgForm.orgEnabled=parseInt(this.nodeData.orgEnabled),this.orgForm.orgUuid=this.nodeData.id},save:function(){var e=this;this.$refs.orgForm.validate(function(t){if(t){var a=e.isCreate?"新增":"修改",r=o()({},e.orgForm);console.log(r),Object(i.a)(r).then(function(t){t.error||(e.$message({message:a+"成功!",type:"success"}),e.$emit("updateTree"),e.isCreate||(r.sortIndex=r.orgSortIndex,r.name=r.orgShortName,console.log(r),e.$emit("updateDetail",r)),e.cancel())})}})},cancel:function(){this.isVisible=!1,this.$emit("update:show",!1),this.orgForm=o()({},s),this.$refs.orgForm.resetFields()}}},c=a("llM8"),d=a.n(c);var u=function(e){a("x1v5")},g=a("C7Lr")(l,d.a,!1,u,"data-v-5ab4268e",null);t.default=g.exports},HiZM:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("aA9S"),o=a.n(r),n=(a("KWYu"),{name:"OrgDetail",data:function(){return{orgNodeData:null}},props:{nodeData:{type:Object,required:!0}},watch:{nodeData:{handler:function(e){this.getDetail()},deep:!0}},methods:{refresh:function(e){this.getDetail()},initDetail:function(){this.orgNodeData=null},getDetail:function(){this.nodeData&&(this.orgNodeData=o()({},this.nodeData))}}}),i=a("YCbL"),s=a.n(i);var l=function(e){a("q5VS")},c=a("C7Lr")(n,s.a,!1,l,"data-v-3fe8f154",null);t.default=c.exports},JQFL:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"organization"},[a("div",{staticClass:"main"},[a("div",{staticClass:"left-tree"},[a("VuePerfectScrollbar",{staticClass:"scroll-area"},[a("tree",{ref:"tree",attrs:{isCreate:e.isCreate,clickedNodeData:e.clickedNodeData},on:{"update:isCreate":function(t){e.isCreate=t},"update:is-create":function(t){e.isCreate=t},nodeClick:e.handleNodeClick,openDialog:e.openDialog,updateTree:e.updateTree}})],1)],1),e._v(" "),a("div",{staticClass:"org-content"},[a("org-detail",{ref:"orgDetail",attrs:{nodeData:e.clickedNodeData}})],1)]),e._v(" "),a("org-update",{attrs:{show:e.showUpdateDialog,isCreate:e.isCreate,nodeData:e.clickedNodeData},on:{"update:show":function(t){e.showUpdateDialog=t},updateDetail:e.updateDetail,updateTree:e.updateTree}})],1)},staticRenderFns:[]}},VohW:function(e,t){},YCbL:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"org-content"},[e.orgNodeData?a("div",{staticClass:"main-content"},[a("div",{staticClass:"org-form"},[a("el-row",[a("el-col",{attrs:{span:12}},[a("span",{staticClass:"label"},[e._v("机构全称")]),e._v(" "),a("span",{staticClass:"content"},[e._v(e._s(e.orgNodeData.orgName))])]),e._v(" "),a("el-col",{attrs:{span:12}},[a("span",{staticClass:"label"},[e._v("机构简称")]),e._v(" "),a("span",{staticClass:"content"},[e._v(e._s(e.orgNodeData.name))])])],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("span",{staticClass:"label"},[e._v("上级机构")]),e._v(" "),a("span",{staticClass:"content"},[e._v(e._s(e.orgNodeData.pName||e.orgNodeData.name))])])],1),e._v(" "),a("el-row"),e._v(" "),a("el-row",[a("el-col",{attrs:{span:24}},[a("span",{staticClass:"label"},[e._v("机构描述")]),e._v(" "),a("span",{staticClass:"content"},[e._v(e._s(e.orgNodeData.orgDesc))])])],1)],1)]):a("div",{staticClass:"empty"},[a("h3",[e._v("请在左侧选择一个机构")]),e._v(" "),a("h5",[e._v("右击节点可进行操作")])])])},staticRenderFns:[]}},ZP6G:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-contextmenu",{ref:"treeMenu"},[a("v-contextmenu-item",{on:{click:e.createOrg}},[e._v("新增机构")]),e._v(" "),a("v-contextmenu-item",{on:{click:e.editOrg}},[e._v("修改机构")]),e._v(" "),a("v-contextmenu-item",{attrs:{disabled:e.contextmenuSelectedNode&&""===e.contextmenuSelectedNode.pId},on:{click:e.deleteOrg}},[e._v("删除机构")])],1),e._v(" "),a("el-tree",{ref:"tree",attrs:{data:e.orgTreeData,"node-key":"id",props:e.defaultProps,"default-expand-all":"","expand-on-click-node":!1,"render-content":e.customRender},on:{"node-contextmenu":e.showContextMenu,"node-click":e.handleNodeClick}})],1)},staticRenderFns:[]}},a6JO:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("sNXC"),o=a.n(r),n=a("4YfN"),i=a.n(n),s=a("R4Sj"),l=a("TVaK"),c=a("QPLA"),d=a("KWYu"),u={name:"OrganizationTree",data:function(){return{orgTreeData:[],contextmenuSelectedNode:null,defaultProps:{label:"orgName"}}},props:{clickedNodeData:{type:Object}},computed:i()({},Object(s.b)(["systemTheme"]),{selectedNode:function(){return this.clickedNodeData},systemColor:function(){return l.a[this.systemTheme]}}),mounted:function(){this.initOrgTree()},methods:{initOrgTree:function(){var e=this;Object(d.c)().then(function(t){e.orgTreeData=Object(c.a)(t),console.log(e.orgTreeData)})},handleNodeClick:function(e,t,a){this.$emit("nodeClick",{data:e,node:t,nodeCom:a})},showContextMenu:function(e,t,a,r){if(a){var o=this.$refs.tree,n=this.$refs.treeMenu;this.contextmenuSelectedNode=t,o.setCurrentKey(t.id),n.show({top:e.clientY,left:e.clientX})}},update:function(){this.initOrgTree()},createOrg:function(){this.$emit("update:isCreate",!0),this.$emit("openDialog","OrgUpdate",this.contextmenuSelectedNode)},editOrg:function(){this.$emit("update:isCreate",!1),this.$emit("openDialog","OrgUpdate",this.contextmenuSelectedNode)},deleteOrg:function(){var e=this,t=this.contextmenuSelectedNode,a=(t.name,t.id);if(a){this.$confirm("确认删除该机构及其下属机构吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(d.b)({orgUuid:a}).then(function(t){t.error||(e.$message({type:"success",message:"删除成功!"}),e.initOrgTree(),e.$emit("updateTree","delete"))})}).catch(function(){})}},customRender:function(e,t){var a=t.node,r=t.data,n=(t.store,this.$createElement);return n("span",o()([{class:"custom-tree-node"},{directives:[{name:"contextmenu",arg:"treeMenu"}]}]),[n("span",[a.label]),this.$refs.tree.getCurrentNode()&&r.id===this.$refs.tree.getCurrentNode().id&&n("span",{class:"active",style:{backgroundColor:this.systemColor}})])}}},g=a("ZP6G"),m=a.n(g);var p=function(e){a("piOk")},h=a("C7Lr")(u,m.a,!1,p,"data-v-64a075f4",null);t.default=h.exports},llM8:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{width:"670px",title:(e.isCreate?"新增":"编辑")+"机构",visible:e.isVisible},on:{"update:visible":function(t){e.isVisible=t},close:e.cancel}},[a("div",{staticClass:"org-form"},[a("el-form",{ref:"orgForm",attrs:{inline:!0,model:e.orgForm,rules:e.orgFormRules,disabled:e.isFormDisabled,"label-width":"100px"}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"机构名称",prop:"orgName"}},[a("el-input",{attrs:{clearable:""},model:{value:e.orgForm.orgName,callback:function(t){e.$set(e.orgForm,"orgName",t)},expression:"orgForm.orgName"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"机构简称",prop:"orgShortName"}},[a("el-input",{attrs:{clearable:""},model:{value:e.orgForm.orgShortName,callback:function(t){e.$set(e.orgForm,"orgShortName",t)},expression:"orgForm.orgShortName"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"上级机构",prop:"orgParentName"}},[a("el-input",{attrs:{disabled:"",clearable:""},model:{value:e.orgForm.orgParentName,callback:function(t){e.$set(e.orgForm,"orgParentName",t)},expression:"orgForm.orgParentName"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"机构描述",prop:"orgDesc"}},[a("el-input",{staticStyle:{width:"495px"},attrs:{type:"textarea",maxlength:"200",rows:5,placeholder:"填写机构描述，最长200字符",clearable:""},model:{value:e.orgForm.orgDesc,callback:function(t){e.$set(e.orgForm,"orgDesc",t)},expression:"orgForm.orgDesc"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{staticClass:"flex-right",attrs:{span:24}},[a("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("保存")]),e._v(" "),a("el-button",{on:{click:e.cancel}},[e._v("取消")])],1)],1)],1)],1)])},staticRenderFns:[]}},piOk:function(e,t){},q5VS:function(e,t){},wt5c:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("wppO"),o=a.n(r),n=a("a6JO"),i=a("HiZM"),s=a("Fb61"),l={name:"OrganizationManagement",data:function(){return{clickedNodeData:{},showUpdateDialog:!1,isCreate:!0}},methods:{handleNodeClick:function(e){var t=e.data;e.node,e.nodeCom;this.clickedNodeData=t},updateTree:function(e){this.$refs.tree.update(),"delete"===e?this.$refs.orgDetail.initDetail():this.$refs.orgDetail.refresh()},updateDetail:function(e){this.clickedNodeData=e},openDialog:function(e,t){console.log(e),this.clickedNodeData=t,this.showUpdateDialog=!0}},components:{VuePerfectScrollbar:o.a,Tree:n.default,OrgDetail:i.default,OrgUpdate:s.default}},c=a("JQFL"),d=a.n(c);var u=function(e){a("VohW")},g=a("C7Lr")(l,d.a,!1,u,"data-v-558242d0",null);t.default=g.exports},x1v5:function(e,t){}});
//# sourceMappingURL=11.9760e0c44ca0563eac9a.js.map