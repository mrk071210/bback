{"version":3,"sources":["webpack:///source/admin/src/views/SystemManagement/User/Components/UserRoleAuth.vue","webpack:///./source/admin/src/views/SystemManagement/User/Components/UserRoleAuth.vue","webpack:///./source/admin/src/views/SystemManagement/User/Components/UserRoleAuth.vue?9e18"],"names":["UserRoleAuth","name","data","isVisible","tableData","currentId","selectRow","isListLoading","pagination","pageNum","pageSize","total","props","show","type","Boolean","required","selectedUsers","Object","watch","isShow","this","queryList","userUuid","methods","params","searchParams","getRoles","extends_default","_this","role","then","res","item","forEach","row","checked","roleUuid","changePage","indexMethod","index","formatStatus","column","roleEnable","formatCreateDate","moment_default","roleCreateTime","utcOffset","format","rowClick","save","_this2","userRoleUserUuid","userRoleRoleUuid","user","error","$message","message","cancel","$emit","components","CommonWrapper","commonWrapper","CommonTable","commonTable","Component","__webpack_require__","normalizeComponent","UserRoleAuth_default","a","__webpack_exports__","module","exports","render","_vm","_h","$createElement","_c","_self","attrs","width","title","visible","close-on-click-modal","close-on-press-escape","on","update:visible","$event","close","staticStyle","margin","slot","directives","rawName","value","expression","ref","height","stripe","row-click","align","scopedSlots","_u","key","fn","scope","staticClass","label","model","callback","$$v","_v","prop","formatter","background","layout","current-page","page-size","update:currentPage","$set","update:current-page","current-change","show-icon","closable","disabled","click","staticRenderFns"],"mappings":"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","file":"static/js/119.6df9f11ea14cdb9297d6.js","sourcesContent":["<template>\r\n    <el-dialog\r\n        width=\"600px\"\r\n        title=\"角色授权\"\r\n        :visible.sync=\"isVisible\"\r\n        :close-on-click-modal=\"false\"\r\n        :close-on-press-escape=\"false\"\r\n         @close=\"cancel\"\r\n    >\r\n      <common-wrapper style=\"margin:10px 0;\">\r\n          <common-table>\r\n              <template slot=\"table\">\r\n                  <el-table\r\n                      ref=\"roleTable\"\r\n                      height=\"350px\"\r\n                      stripe\r\n                      v-loading=\"isListLoading\"\r\n                      :data=\"tableData\"\r\n                      @row-click = \"rowClick\">\r\n                      <el-table-column width=\"55\" align=\"center\">\r\n                        <template slot-scope=\"scope\">\r\n                          <el-radio class=\"radio\" :label=\"scope.row.roleUuid\" v-model=\"currentId\">&nbsp</el-radio>\r\n                        </template>\r\n                      </el-table-column>\r\n                      <el-table-column type=\"index\" :index=\"indexMethod\" label=\"序号\" width=\"50\"></el-table-column>\r\n                      <el-table-column prop=\"roleName\" label=\"角色名称\"></el-table-column>\r\n                      <el-table-column prop=\"roleEnable\" label=\"状态\" :formatter=\"formatStatus\"></el-table-column>\r\n                      <el-table-column prop=\"roleCreateTime\" label=\"创建时间\" :formatter=\"formatCreateDate\"></el-table-column>\r\n                  </el-table>\r\n              </template>\r\n              <template slot=\"pagination\">\r\n                  <el-pagination   background   layout=\"total, prev, pager, next\"\r\n                  :current-page.sync=\"pagination.pageNum\"\r\n                  :page-size=\"pagination.pageSize\"\r\n                  :total=\"pagination.total\"\r\n                  @current-change=\"changePage\"\r\n                  ></el-pagination>\r\n              </template>\r\n          </common-table>\r\n      </common-wrapper>\r\n      <el-alert title=\"您勾选的角色信息将覆盖账号原角色信息.\" type=\"warning\" show-icon :closable=\"false\"></el-alert>\r\n      <template slot=\"footer\">\r\n          <el-button type=\"primary\" @click=\"save\" :disabled=\"!this.currentId\">保存</el-button>\r\n          <el-button @click=\"cancel\">取消</el-button>\r\n      </template>\r\n    </el-dialog>\r\n</template>\r\n<script>\r\n/**\r\n * User Role Authorization Component\r\n * ----------------------\r\n * Author: zhou qi\r\n * Date: 2018.03.20\r\n */\r\nimport moment from 'moment'\r\nimport CommonWrapper from '@/components/commonWrapper'\r\nimport CommonTable from '@/components/commonTable'\r\n\r\n// api\r\nimport { setUserRole } from '@/api/user'\r\nimport { getRoleList } from '@/api/role'\r\n\r\nexport default {\r\n  name: 'UserRoleAuth',\r\n  data () {\r\n    return {\r\n      isVisible: false,\r\n      tableData: [],\r\n      currentId: '',\r\n      selectRow: {}, // 列表选中列\r\n      isListLoading: false,\r\n      pagination: { // 翻页数据\r\n        pageNum: 1,\r\n        pageSize: 10,\r\n        total: 0\r\n      }\r\n    }\r\n  },\r\n  props: {\r\n    show: {\r\n      type: Boolean,\r\n      required: true\r\n    },\r\n    selectedUsers: {\r\n      type: Object,\r\n      required: true\r\n    }\r\n  },\r\n  watch: {\r\n    show (isShow) {\r\n      if (isShow) {\r\n        this.currentId = ''\r\n        this.queryList({userUuid: this.selectedUsers.userUuid})\r\n      }\r\n      this.isVisible = isShow\r\n    }\r\n  },\r\n  methods: {\r\n    // 查询和初始化查询\r\n    // 查询/翻页公用方法\r\n    queryList (params) {\r\n      const searchParams = this.searchParams = params\r\n      this.getRoles(\r\n        {\r\n          ...searchParams,\r\n          pageNum: this.pagination.pageNum,\r\n          pageSize: this.pagination.pageSize\r\n        }\r\n      )\r\n    },\r\n    // 获取列表\r\n    getRoles (params) {\r\n      this.isListLoading = true\r\n      getRoleList(params).then(res => {\r\n        this.tableData = res.item\r\n        this.pagination.total = res.total\r\n        this.pagination.pageNum = res.pageNum\r\n        this.pagination.pageSize = res.pageSize\r\n        this.isListLoading = false\r\n        this.tableData.forEach(row => {\r\n          if(row.checked){\r\n            this.currentId = row.roleUuid;\r\n          }\r\n        });\r\n      })\r\n    },\r\n    // 列表翻页\r\n    changePage (pageNum) {\r\n      this.pagination.pageNum = pageNum\r\n      this.queryList(this.searchParams)\r\n    },\r\n    // 生成列表序号\r\n    indexMethod (index) {\r\n      return (index + 1) + (this.pagination.pageNum - 1) * this.pagination.pageSize\r\n    },\r\n    // 列表状态显示格式化\r\n    formatStatus (row, column) {\r\n      return row.roleEnable === 1 ? '正常' : row.roleEnable === 0 ? '禁用' : '未知'\r\n    },\r\n    // 列表日期格式化\r\n    formatCreateDate (row) {\r\n      return moment(row.roleCreateTime).utcOffset(8).format('YYYY-MM-DD')\r\n    },\r\n    rowClick (row) {\r\n      this.currentId = row.roleUuid;\r\n    },\r\n    save () {\r\n      const userRoleUserUuid = this.selectedUsers.userUuid\r\n      const userRoleRoleUuid = this.currentId\r\n      setUserRole({userRoleUserUuid, userRoleRoleUuid}).then(res => {\r\n        if(!res.error){\r\n          this.$message({\r\n            message: '用户授权成功!',\r\n            type: 'success'\r\n          })\r\n          this.cancel()\r\n          this.$emit('updateList')\r\n        }\r\n      })\r\n    },\r\n    cancel () {\r\n      this.$emit('update:show', false)\r\n      this.isVisible = false\r\n    }\r\n  },\r\n  components: {\r\n    CommonWrapper,\r\n    CommonTable\r\n  }\r\n}\r\n</script>\r\n\n\n\n// WEBPACK FOOTER //\n// source/admin/src/views/SystemManagement/User/Components/UserRoleAuth.vue","var normalizeComponent = require(\"!../../../../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./UserRoleAuth.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./UserRoleAuth.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-77010d92\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=template&index=0!./UserRoleAuth.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = null\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./source/admin/src/views/SystemManagement/User/Components/UserRoleAuth.vue\n// module id = null\n// module chunks = ","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-dialog',{attrs:{\"width\":\"600px\",\"title\":\"角色授权\",\"visible\":_vm.isVisible,\"close-on-click-modal\":false,\"close-on-press-escape\":false},on:{\"update:visible\":function($event){_vm.isVisible=$event},\"close\":_vm.cancel}},[_c('common-wrapper',{staticStyle:{\"margin\":\"10px 0\"}},[_c('common-table',[_c('template',{slot:\"table\"},[_c('el-table',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.isListLoading),expression:\"isListLoading\"}],ref:\"roleTable\",attrs:{\"height\":\"350px\",\"stripe\":\"\",\"data\":_vm.tableData},on:{\"row-click\":_vm.rowClick}},[_c('el-table-column',{attrs:{\"width\":\"55\",\"align\":\"center\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-radio',{staticClass:\"radio\",attrs:{\"label\":scope.row.roleUuid},model:{value:(_vm.currentId),callback:function ($$v) {_vm.currentId=$$v},expression:\"currentId\"}},[_vm._v(\" \")])]}}])}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"type\":\"index\",\"index\":_vm.indexMethod,\"label\":\"序号\",\"width\":\"50\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"roleName\",\"label\":\"角色名称\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"roleEnable\",\"label\":\"状态\",\"formatter\":_vm.formatStatus}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"roleCreateTime\",\"label\":\"创建时间\",\"formatter\":_vm.formatCreateDate}})],1)],1),_vm._v(\" \"),_c('template',{slot:\"pagination\"},[_c('el-pagination',{attrs:{\"background\":\"\",\"layout\":\"total, prev, pager, next\",\"current-page\":_vm.pagination.pageNum,\"page-size\":_vm.pagination.pageSize,\"total\":_vm.pagination.total},on:{\"update:currentPage\":function($event){return _vm.$set(_vm.pagination, \"pageNum\", $event)},\"update:current-page\":function($event){return _vm.$set(_vm.pagination, \"pageNum\", $event)},\"current-change\":_vm.changePage}})],1)],2)],1),_vm._v(\" \"),_c('el-alert',{attrs:{\"title\":\"您勾选的角色信息将覆盖账号原角色信息.\",\"type\":\"warning\",\"show-icon\":\"\",\"closable\":false}}),_vm._v(\" \"),_c('template',{slot:\"footer\"},[_c('el-button',{attrs:{\"type\":\"primary\",\"disabled\":!this.currentId},on:{\"click\":_vm.save}},[_vm._v(\"保存\")]),_vm._v(\" \"),_c('el-button',{on:{\"click\":_vm.cancel}},[_vm._v(\"取消\")])],1)],2)}\nvar staticRenderFns = []\nmodule.exports = { render: render, staticRenderFns: staticRenderFns }\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler?{\"id\":\"data-v-77010d92\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@13.7.3@vue-loader/lib/selector.js?type=template&index=0!./source/admin/src/views/SystemManagement/User/Components/UserRoleAuth.vue\n// module id = XIzm\n// module chunks = 15 119"],"sourceRoot":""}