webpackJsonp([23,84,112],{"+nsI":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("rVsN"),s=a.n(r),n=a("4YfN"),i=a.n(n),o=a("ryJa"),l=a.n(o),c=a("dF+P"),u=a("Jky9"),m=a("Jns3"),h=a("0+j4"),d=a("aIe1"),p=a("MZXF"),f=a("FNPw"),g=a("bJK+"),b=a("4+6g"),v=a("I8tE"),w=(a("fBur"),{name:"MaintenanceManagement",mixins:[c.a],components:{NavButton:u.a,NavPremissonButton:m.a,CommonWrapper:h.a,CommonTable:d.a,MainManagementSearch:p.default,statusChange:f.default},data:function(){return{comp:this,buttonData:[],tableData:[],selectRow:[],choosedIds:[],merchantsList:[],isListLoading:!1,StatusTrueflag:!1,warehouseList:this.$store.getters.warehouseList,isCreateFormVisible:!1,isEditFormVisible:!1,isRoleAuthVisible:!1,modifyUser:null,isChangeVisible:!1,Maintext:"",pagination:{pageNum:1,pageSize:10,total:0},searchParams:{}}},activated:function(){this.$refs.userTable.doLayout()},mounted:function(){},methods:{queryList:function(e){var t=this.searchParams=e;this.getUsers(i()({},t,{pageNum:this.pagination.pageNum,pageSize:this.pagination.pageSize}))},getWarehouse:function(){var e=this;Object(v.n)().then(function(t){console.info("warehouse=>",t),e.warehouseList=t})},getMerchantsList:function(e){var t=this;return new s.a(function(a){Object(b.f)(e).then(function(e){e.error||(t.merchantsList=e,a())})})},getUsers:function(e){var t=this;this.isListLoading=!0,Object(v.q)(e).then(function(a){if(0==a.item.length&&a.pageNum>1)return t.pagination.pageNum=1,e.pageNum=1,void t.getUsers(e);t.tableData=a.item,t.pagination.total=a.total,t.pagination.pageNum=a.pageNum,t.pagination.pageSize=a.pageSize,t.isListLoading=!1})},rest:function(e){var t=this.searchParams=e;this.getUsers(i()({},t,{pageNum:1,pageSize:this.pagination.pageSize}))},handleSelectionChange:function(e){var t=this;this.selectRow=e;var a=[];this.StatusTrueflag=!1,this.choosedIds=this.selectRow.map(function(e){a.push(e.goodRepairUuid),1==e.goodRepairStatus&&(t.StatusTrueflag=!0)})},isButtonIsDisabled:function(){return!(this.selectRow.length>0&&!this.StatusTrueflag)},handleMaintained:function(e){this.Maintext=1==e?"已修复":"未修复",this.selectRow.length?this.StatusTrueflag?this.$message({message:"所选择项中有已修复的数据，请重新选择！",type:"warning"}):this.isChangeVisible=!0:this.$message({type:"warning",message:"请至少选择一项"})},isButtonDisabled:function(){return!!this.selectRow.length},formatState:function(e,t){switch(e.goodRepairStatus){case"0":return"待修复";case"1":return"已修复";case"2":return"修复未通过"}},formatResult:function(e,t){switch(e.goodRepairResult){case"0":return"继续收货";case"1":return"返厂";case"2":return"第三方维修";case"3":return"星和宅配维修"}},typeFormatter:function(e){switch(e.productPackFlag){case"0":return"小件";case"1":return"套件";case"2":return"单品";default:return"未知"}},getUserDetail:function(e,t){},handleDel:function(e,t){this.$confirm("确认删除该吗?","提示",{type:"warning"}).then(function(){}).catch(function(){})},batchRemove:function(){var e=this;this.$confirm("确认删除选中吗？","提示",{type:"warning"}).then(function(){var t=[];e.selectRow.map(function(e){return t.push(e.userUuid)}),e.isListLoading=!0}).catch(function(){})},deleteUsers:function(e){var t=this;return Object(g.b)(e).then(function(e){t.$message({message:"删除成功",type:"success"}),t.queryList()})},changePage:function(e){this.pagination.pageNum=e,this.queryList(this.searchParams)},indexMethod:function(e){return e+1+(this.pagination.pageNum-1)*this.pagination.pageSize},formatStatus:function(e,t){return"1"===e.userEnable?"启用":"0"===e.userEnable?"禁用":"未知"},formatCreateDate:function(e){return l()(e.userCreateTime).utcOffset(8).format("YYYY-MM-DD")}}}),y=a("E6Bk"),F=a.n(y),_=a("C7Lr")(w,F.a,!1,null,null,null);t.default=_.exports},"5fSD":function(e,t){},D7oy:function(e,t){},E6Bk:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("common-wrapper",[a("main-management-search",{staticClass:"search",attrs:{warehouseList:e.warehouseList,merchantsList:e.merchantsList},on:{search:e.queryList,getMerchants:e.getMerchantsList,rest:e.rest}})],1),e._v(" "),a("nav-button",[a("el-button-group",[a("el-button",{attrs:{icon:"fdddfont icon-shouquan",disabled:e.isButtonIsDisabled()},on:{click:function(t){return e.handleMaintained(1)}}},[e._v("已修复")]),e._v(" "),a("el-button",{attrs:{icon:"fdddfont icon-add-new",disabled:e.isButtonIsDisabled()},on:{click:function(t){return e.handleMaintained(2)}}},[e._v("未修复")])],1),e._v(" "),e.StatusTrueflag?a("span",{staticStyle:{color:"red"}},[e._v("已修复的数据不能再操作，请取消勾选！")]):e._e()],1),e._v(" "),a("common-wrapper",[a("common-table",{attrs:{flex:270}},[a("template",{slot:"table"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.isListLoading,expression:"isListLoading"}],ref:"userTable",attrs:{height:"100%",stripe:"",border:!0,data:e.tableData},on:{"row-click":e.getUserDetail,"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"30"}}),e._v(" "),a("el-table-column",{attrs:{sortable:"",prop:"orderUuid",label:"收货单号",width:"150"}}),e._v(" "),a("el-table-column",{attrs:{sortable:"",prop:"merchantName",label:"商户","min-width":"120"}}),e._v(" "),a("el-table-column",{attrs:{sortable:"",prop:"productBrand",label:"品牌"}}),e._v(" "),a("el-table-column",{attrs:{sortable:"",prop:"productName",label:"货品名称"}}),e._v(" "),a("el-table-column",{attrs:{sortable:"",prop:"productModel",label:"型号"}}),e._v(" "),a("el-table-column",{attrs:{sortable:"",prop:"productColor",label:"颜色"}}),e._v(" "),a("el-table-column",{attrs:{sortable:"",prop:"productPackFlag",label:"货品类型",formatter:e.typeFormatter}}),e._v(" "),a("el-table-column",{attrs:{prop:"goodRepairResult",label:"维修方式",width:"120",formatter:e.formatResult}}),e._v(" "),a("el-table-column",{attrs:{prop:"goodRepairStatus",label:"状态",width:"80",formatter:e.formatState}}),e._v(" "),a("el-table-column",{attrs:{sortable:"",prop:"warehousName",label:"仓库",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"goodTestRemark",label:"质检不通过的原因","min-width":"120","show-tooltip-when-overflow":!0}})],1)],1),e._v(" "),a("template",{slot:"pagination"},[a("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next","current-page":e.pagination.pageNum,"page-size":e.pagination.pageSize,total:e.pagination.total},on:{"update:currentPage":function(t){return e.$set(e.pagination,"pageNum",t)},"update:current-page":function(t){return e.$set(e.pagination,"pageNum",t)},"current-change":e.changePage}})],1)],2)],1),e._v(" "),a("status-change",{attrs:{show:e.isChangeVisible,modifyUser:e.selectRow,searchParams:e.searchParams,flag:e.Maintext},on:{"update:show":function(t){e.isChangeVisible=t},"update:modifyUser":function(t){e.selectRow=t},"update:modify-user":function(t){e.selectRow=t},updateList:e.queryList}})],1)},staticRenderFns:[]}},F7c4:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{width:"600px",visible:e.isVisible,"close-on-click-modal":!1,"close-on-press-escape":!1,title:"提示",center:""},on:{"update:visible":function(t){e.isVisible=t},close:e.cancel}},[a("el-alert",{attrs:{title:e.title,type:"warning",closable:!1}}),e._v(" "),a("br"),e._v(" "),a("el-form",{ref:"maintenanceForm",attrs:{model:e.maintenanceForm,rules:e.formRules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"维修报告",prop:"goodTestRemark"}},[a("el-input",{attrs:{placeholder:"请输入维修报告,最长200字符",autosize:{maxRows:3},type:"textarea",maxlength:"200"},model:{value:e.maintenanceForm.goodTestRemark,callback:function(t){e.$set(e.maintenanceForm,"goodTestRemark",t)},expression:"maintenanceForm.goodTestRemark"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.save}},[e._v("提交")]),e._v(" "),a("el-button",{attrs:{size:"small"},on:{click:e.cancel}},[e._v("取消")])],1)],1)},staticRenderFns:[]}},FNPw:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("HzJ8"),s=a.n(r),n=(a("uTPb"),a("I8tE")),i={name:"mainForm",data:function(){return{isVisible:!1,maintenanceForm:{goodRepairStatus:"",goodRepairs:[],goodTestRemark:""},formRules:{}}},props:{flag:{type:String},show:{type:Boolean,default:!1},modifyUser:{type:Array},searchParams:{type:Object}},computed:{title:function(){return"此操作将修改维修状态为"+this.flag+"!"}},watch:{show:function(e){this.isVisible=e}},methods:{save:function(){var e=this;this.$refs.maintenanceForm.validate(function(t){if(t){var a={goodRepairStatus:"已修复"===e.flag?"1":"未修复"===e.flag?"2":"",goodRepairs:[],goodTestRemark:e.maintenanceForm.goodTestRemark},r=!0,i=!1,o=void 0;try{for(var l,c=s()(e.modifyUser);!(r=(l=c.next()).done);r=!0){var u=l.value;a.goodRepairs.push(u.goodRepairUuid)}}catch(e){i=!0,o=e}finally{try{!r&&c.return&&c.return()}finally{if(i)throw o}}Object(n.r)(a).then(function(t){t.error||(e.$message({message:"维修状态设置成功",type:"success"}),e.$refs.maintenanceForm.resetFields(),e.$emit("updateList",e.searchParams),e.$emit("update:show",!1),e.isVisible=!1)})}})},cancel:function(){this.$refs.maintenanceForm.resetFields(),this.$emit("update:show",!1),this.isVisible=!1}}},o=a("F7c4"),l=a.n(o);var c=function(e){a("D7oy")},u=a("C7Lr")(i,l.a,!1,c,"data-v-544e71c9",null);t.default=u.exports},MZXF:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("aA9S"),s=a.n(r),n=a("fBur"),i=a("ryJa"),o=a.n(i),l={name:"MainManagementSearch",data:function(){return{searchForm:{storageUuid:"",warehouseUuid:"",merchantUuid:"",timeRange:[],status:"",inventoryUuid:"",productTempleteUuid:"",testFrom:"",beginDate:"",endDate:"",orderId:""}}},mounted:function(){this.searchForm.warehouseUuid=Object(n.b)("warehouseUuid"),this.search(),this.getMerchantsList(this.searchForm.warehouseUuid)},props:{warehouseList:{type:Array,required:!0},merchantsList:{type:Array,required:!0}},methods:{getMerchantsList:function(e){Object(n.e)("warehouseUuid",e),this.searchForm.merchantUuid="",this.$emit("getMerchants",s()({},this.searchForm))},search:function(){if(this.searchForm.endDate&&this.searchForm.beginDate&&(o()(this.searchForm.endDate).isBefore(this.searchForm.beginDate)||o()(this.searchForm.endDate).isSame(this.searchForm.beginDate)))return this.$message({message:"结束日期不能早于开始日期，请重新选择！",type:"warning"}),void(this.searchForm.endDate=null);this.$emit("search",s()({},this.searchForm))},resetForm:function(e){this.$refs[e].resetFields(),this.searchForm.warehouseUuid=Object(n.b)("warehouseUuid"),this.$emit("rest",s()({},this.searchForm))}}},c=a("ovMC"),u=a.n(c);var m=function(e){a("5fSD")},h=a("C7Lr")(l,u.a,!1,m,"data-v-13399b0d",null);t.default=h.exports},ovMC:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"searchForm",attrs:{model:e.searchForm,"label-width":"80px"}},[a("el-row",[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"仓库",prop:"warehouseUuid"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择仓库"},on:{change:e.getMerchantsList},model:{value:e.searchForm.warehouseUuid,callback:function(t){e.$set(e.searchForm,"warehouseUuid",t)},expression:"searchForm.warehouseUuid"}},e._l(e.warehouseList,function(t,r){return a("el-option",{key:r,attrs:{label:t.warehouseName,value:t.warehouseUuid}},[e._v(e._s(t.warehouseName))])}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"收货单号",prop:"orderId"}},[a("el-input",{attrs:{placeholder:"请输入收货单号",clearable:""},model:{value:e.searchForm.orderId,callback:function(t){e.$set(e.searchForm,"orderId",t)},expression:"searchForm.orderId"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"商户",prop:"merchantUuid"}},[a("el-select",{attrs:{clearable:"",filterable:"",placeholder:"请选择商户"},model:{value:e.searchForm.merchantUuid,callback:function(t){e.$set(e.searchForm,"merchantUuid",t)},expression:"searchForm.merchantUuid"}},e._l(e.merchantsList,function(t,r){return a("el-option",{key:r,attrs:{label:t.userName,value:t.userUuid}},[e._v(e._s(t.userName))])}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"状态",prop:"status"}},[a("el-select",{attrs:{placeholder:"请选择状态",filterable:"",clearable:""},model:{value:e.searchForm.status,callback:function(t){e.$set(e.searchForm,"status",t)},expression:"searchForm.status"}},[a("el-option",{attrs:{label:"待修复",value:"0"}}),e._v(" "),a("el-option",{attrs:{label:"已修复",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"修复未通过",value:"2"}})],1)],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"开始日期",prop:"beginDate"}},[a("el-date-picker",{staticClass:"w100p",attrs:{type:"date",align:"right",clearable:"","unlink-panels":"","range-separator":"至",placeholder:"请选择开始日期",format:"yyyy 年 MM 月 dd 日","value-format":"yyyy-MM-dd",size:"mini"},model:{value:e.searchForm.beginDate,callback:function(t){e.$set(e.searchForm,"beginDate",t)},expression:"searchForm.beginDate"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"结束日期",prop:"endDate"}},[a("el-date-picker",{staticClass:"w100p",attrs:{type:"date",align:"right",clearable:"","unlink-panels":"","range-separator":"至",placeholder:"请选择结束日期",format:"yyyy 年 MM 月 dd 日","value-format":"yyyy-MM-dd",size:"mini"},model:{value:e.searchForm.endDate,callback:function(t){e.$set(e.searchForm,"endDate",t)},expression:"searchForm.endDate"}})],1)],1),e._v(" "),a("el-col",{staticClass:"flex-right",attrs:{span:6}},[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.search(t)}}},[e._v("查询")]),e._v(" "),a("el-button",{on:{click:function(t){return e.resetForm("searchForm")}}},[e._v("重置")])],1)],1)],1)},staticRenderFns:[]}}});
//# sourceMappingURL=23.204ca012a854570b18e0.js.map