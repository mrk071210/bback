{"version":3,"sources":["webpack:///./source/admin/src/views/Development/ProductTemplate/Components/UserRoleAuth.vue?f10f","webpack:///source/admin/src/views/Development/ProductTemplate/Components/UserRoleAuth.vue","webpack:///./source/admin/src/views/Development/ProductTemplate/Components/UserRoleAuth.vue"],"names":["module","exports","render","_vm","this","_h","$createElement","_c","_self","attrs","width","title","visible","isVisible","close-on-click-modal","close-on-press-escape","on","update:visible","$event","close","cancel","staticStyle","margin","slot","directives","name","rawName","value","expression","ref","height","stripe","data","tableData","selection-change","selected","selectRow","type","_v","index","indexMethod","label","prop","formatter","formatStatus","formatCreateDate","background","layout","current-page","pagination","pageNum","page-size","pageSize","total","update:currentPage","$set","update:current-page","current-change","changePage","show-icon","closable","disabled","length","click","save","staticRenderFns","UserRoleAuth","isListLoading","props","show","Boolean","required","selectedUsers","Array","watch","isShow","queryList","methods","params","searchParams","getRoles","extends_default","_this","Object","role","then","res","list","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","get_iterator_default","next","done","item","checked","$refs","roleTable","toggleRowSelection","err","return","row","column","rolesEnable","moment_default","rolesCreateTime","utcOffset","format","_this2","checkUserList","map","user","userUuid","checkedRoleIds","roleUuid","error","$message","message","$emit","components","CommonWrapper","commonWrapper","CommonTable","commonTable","Component","__webpack_require__","normalizeComponent","UserRoleAuth_default","a","__webpack_exports__"],"mappings":"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","file":"static/js/135.df51191998ec2235335b.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-dialog',{attrs:{\"width\":\"600px\",\"title\":\"角色授权\",\"visible\":_vm.isVisible,\"close-on-click-modal\":false,\"close-on-press-escape\":false},on:{\"update:visible\":function($event){_vm.isVisible=$event},\"close\":_vm.cancel}},[_c('common-wrapper',{staticStyle:{\"margin\":\"10px 0\"}},[_c('common-table',[_c('template',{slot:\"table\"},[_c('el-table',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.isListLoading),expression:\"isListLoading\"}],ref:\"roleTable\",attrs:{\"height\":\"350px\",\"stripe\":\"\",\"data\":_vm.tableData},on:{\"selection-change\":function (selected) { return _vm.selectRow = selected; }}},[_c('el-table-column',{attrs:{\"type\":\"selection\",\"width\":\"30\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"type\":\"index\",\"index\":_vm.indexMethod,\"label\":\"序号\",\"width\":\"50\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"rolesName\",\"label\":\"角色名称\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"rolesEnable\",\"label\":\"状态\",\"formatter\":_vm.formatStatus}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"rolesCreateTime\",\"label\":\"创建时间\",\"formatter\":_vm.formatCreateDate}})],1)],1),_vm._v(\" \"),_c('template',{slot:\"pagination\"},[_c('el-pagination',{attrs:{\"background\":\"\",\"layout\":\"total, prev, pager, next\",\"current-page\":_vm.pagination.pageNum,\"page-size\":_vm.pagination.pageSize,\"total\":_vm.pagination.total},on:{\"update:currentPage\":function($event){return _vm.$set(_vm.pagination, \"pageNum\", $event)},\"update:current-page\":function($event){return _vm.$set(_vm.pagination, \"pageNum\", $event)},\"current-change\":_vm.changePage}})],1)],2)],1),_vm._v(\" \"),_c('el-alert',{attrs:{\"title\":\"您勾选的角色信息将覆盖账号原角色信息.\",\"type\":\"warning\",\"show-icon\":\"\",\"closable\":false}}),_vm._v(\" \"),_c('template',{slot:\"footer\"},[_c('el-button',{attrs:{\"type\":\"primary\",\"disabled\":!_vm.selectRow.length},on:{\"click\":_vm.save}},[_vm._v(\"保存\")]),_vm._v(\" \"),_c('el-button',{on:{\"click\":_vm.cancel}},[_vm._v(\"取消\")])],1)],2)}\nvar staticRenderFns = []\nmodule.exports = { render: render, staticRenderFns: staticRenderFns }\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler?{\"id\":\"data-v-eba37b06\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@13.7.3@vue-loader/lib/selector.js?type=template&index=0!./source/admin/src/views/Development/ProductTemplate/Components/UserRoleAuth.vue\n// module id = omvA\n// module chunks = 135","<template>\r\n    <el-dialog\r\n        width=\"600px\"\r\n        title=\"角色授权\"\r\n        :visible.sync=\"isVisible\"\r\n        :close-on-click-modal=\"false\"\r\n        :close-on-press-escape=\"false\"\r\n         @close=\"cancel\"\r\n    >\r\n      <common-wrapper style=\"margin:10px 0;\">\r\n          <common-table>\r\n              <template slot=\"table\">\r\n                  <el-table\r\n                      ref=\"roleTable\"\r\n                      height=\"350px\"\r\n                      stripe\r\n                      v-loading=\"isListLoading\"\r\n                      :data=\"tableData\"\r\n                      @selection-change=\"selected => selectRow = selected\">\r\n                      <el-table-column type=\"selection\" width=\"30\"></el-table-column>\r\n                      <el-table-column type=\"index\" :index=\"indexMethod\" label=\"序号\" width=\"50\"></el-table-column>\r\n                      <el-table-column prop=\"rolesName\" label=\"角色名称\"></el-table-column>\r\n                      <el-table-column prop=\"rolesEnable\" label=\"状态\" :formatter=\"formatStatus\"></el-table-column>\r\n                      <el-table-column prop=\"rolesCreateTime\" label=\"创建时间\" :formatter=\"formatCreateDate\"></el-table-column>\r\n                  </el-table>\r\n              </template>\r\n              <template slot=\"pagination\">\r\n                  <el-pagination   background   layout=\"total, prev, pager, next\"\r\n                  :current-page.sync=\"pagination.pageNum\"\r\n                  :page-size=\"pagination.pageSize\"\r\n                  :total=\"pagination.total\"\r\n                  @current-change=\"changePage\"\r\n                  ></el-pagination>\r\n              </template>\r\n          </common-table>\r\n      </common-wrapper>\r\n      <el-alert title=\"您勾选的角色信息将覆盖账号原角色信息.\" type=\"warning\" show-icon :closable=\"false\"></el-alert>\r\n      <template slot=\"footer\">\r\n          <el-button type=\"primary\" @click=\"save\" :disabled=\"!selectRow.length\">保存</el-button>\r\n          <el-button @click=\"cancel\">取消</el-button>\r\n      </template>\r\n    </el-dialog>\r\n</template>\r\n<script>\r\n/**\r\n * User Role Authorization Component\r\n * ----------------------\r\n * Author: zhou qi\r\n * Date: 2018.03.20\r\n */\r\nimport moment from 'moment'\r\nimport CommonWrapper from '@/components/commonWrapper'\r\nimport CommonTable from '@/components/commonTable'\r\n\r\n// api\r\nimport { setUserRole } from '@/api/user'\r\nimport { getRoleList } from '@/api/role'\r\n\r\nexport default {\r\n  name: 'UserRoleAuth',\r\n  data () {\r\n    return {\r\n      isVisible: false,\r\n      tableData: [],\r\n      selectRow: [], // 列表选中列\r\n      isListLoading: false,\r\n      pagination: { // 翻页数据\r\n        pageNum: 1,\r\n        pageSize: 10,\r\n        total: 0\r\n      }\r\n    }\r\n  },\r\n  props: {\r\n    show: {\r\n      type: Boolean,\r\n      required: true\r\n    },\r\n    selectedUsers: {\r\n      type: Array,\r\n      required: true\r\n    }\r\n  },\r\n  watch: {\r\n    show (isShow) {\r\n      if (isShow) {\r\n        this.queryList()\r\n      }\r\n      this.isVisible = isShow\r\n    }\r\n  },\r\n  methods: {\r\n    // 查询和初始化查询\r\n    // 查询/翻页公用方法\r\n    queryList (params) {\r\n      const searchParams = this.searchParams = params\r\n      this.getRoles(\r\n        {\r\n          ...searchParams,\r\n          pageNum: this.pagination.pageNum,\r\n          pageSize: this.pagination.pageSize\r\n        }\r\n      )\r\n    },\r\n    // 获取列表\r\n    getRoles (params) {\r\n      this.isListLoading = true\r\n      getRoleList(params).then(res => {\r\n        this.tableData = res.list\r\n        this.pagination.total = res.total\r\n        this.pagination.pageNum = res.pageNum\r\n        this.pagination.pageSize = res.pageSize\r\n        this.isListLoading = false\r\n        for(let item of this.tableData){\r\n          if(item.checked){\r\n            this.$refs.roleTable.toggleRowSelection(item, true)\r\n          }\r\n        }\r\n      })\r\n    },\r\n    // 列表翻页\r\n    changePage (pageNum) {\r\n      this.pagination.pageNum = pageNum\r\n      this.queryList(this.searchParams)\r\n    },\r\n    // 生成列表序号\r\n    indexMethod (index) {\r\n      return (index + 1) + (this.pagination.pageNum - 1) * this.pagination.pageSize\r\n    },\r\n    // 列表状态显示格式化\r\n    formatStatus (row, column) {\r\n      return row.rolesEnable === '1' ? '正常' : row.rolesEnable === '0' ? '禁用' : '未知'\r\n    },\r\n    // 列表日期格式化\r\n    formatCreateDate (row) {\r\n      return moment(row.rolesCreateTime).utcOffset(8).format('YYYY-MM-DD')\r\n    },\r\n    save () {\r\n      const checkUserList = this.selectedUsers.map(user => user.userUuid)\r\n      const checkedRoleIds = this.selectRow.map(row => row.roleUuid)\r\n      setUserRole({checkUserList, checkedRoleIds}).then(res => {\r\n        if (!res.error) {\r\n          this.$message({\r\n            message: '用户授权成功!',\r\n            type: 'success'\r\n          })\r\n          this.cancel()\r\n          this.$emit('updateList')\r\n        }\r\n      })\r\n    },\r\n    cancel () {\r\n      this.$emit('update:show', false)\r\n      this.isVisible = false\r\n    }\r\n  },\r\n  components: {\r\n    CommonWrapper,\r\n    CommonTable\r\n  }\r\n}\r\n</script>\r\n\n\n\n// WEBPACK FOOTER //\n// source/admin/src/views/Development/ProductTemplate/Components/UserRoleAuth.vue","var normalizeComponent = require(\"!../../../../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./UserRoleAuth.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./UserRoleAuth.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-eba37b06\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=template&index=0!./UserRoleAuth.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = null\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./source/admin/src/views/Development/ProductTemplate/Components/UserRoleAuth.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}