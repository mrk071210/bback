webpackJsonp([20,42,45],{"7g4z":function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"searchForm",attrs:{model:e.searchForm,"label-width":"80px"}},[a("el-row",[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"仓库",prop:"warehouseUuid"}},[a("el-select",{attrs:{placeholder:"请选择仓库"},on:{change:e.getMerchantsList},model:{value:e.searchForm.warehouseUuid,callback:function(t){e.$set(e.searchForm,"warehouseUuid",t)},expression:"searchForm.warehouseUuid"}},e._l(e.warehouseList,function(t,r){return a("el-option",{key:r,attrs:{label:t.warehouseName,value:t.warehouseUuid}},[e._v(e._s(t.warehouseName))])}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"单号",prop:"orderUuid"}},[a("el-input",{attrs:{placeholder:"请输入单号",clearable:""},model:{value:e.searchForm.orderUuid,callback:function(t){e.$set(e.searchForm,"orderUuid",t)},expression:"searchForm.orderUuid"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"商户",prop:"merchantUuid"}},[a("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择商户"},model:{value:e.searchForm.merchantUuid,callback:function(t){e.$set(e.searchForm,"merchantUuid",t)},expression:"searchForm.merchantUuid"}},e._l(e.merchantsList,function(t,r){return a("el-option",{key:r,attrs:{label:t.userName,value:t.userUuid}},[e._v(e._s(t.userName))])}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"质检来源",prop:"testForm"}},[a("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择质检来源"},model:{value:e.searchForm.testForm,callback:function(t){e.$set(e.searchForm,"testForm",t)},expression:"searchForm.testForm"}},e._l(e.originList,function(t,r){return a("el-option",{key:r,attrs:{label:t.name,value:t.id}},[e._v(e._s(t.name))])}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"质检开始日期",prop:"beginDate","label-width":"100px"}},[a("el-date-picker",{staticClass:"w100p",attrs:{type:"date",align:"right",clearable:"","unlink-panels":"","range-separator":"至",placeholder:"请选择开始日期",format:"yyyy 年 MM 月 dd 日","value-format":"yyyy-MM-dd",size:"mini"},model:{value:e.searchForm.beginDate,callback:function(t){e.$set(e.searchForm,"beginDate",t)},expression:"searchForm.beginDate"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"质检结束日期",prop:"endDate","label-width":"100px"}},[a("el-date-picker",{staticClass:"w100p",attrs:{type:"date",align:"right",clearable:"","unlink-panels":"","range-separator":"至",placeholder:"请选择结束日期",format:"yyyy 年 MM 月 dd 日","value-format":"yyyy-MM-dd",size:"mini"},model:{value:e.searchForm.endDate,callback:function(t){e.$set(e.searchForm,"endDate",t)},expression:"searchForm.endDate"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"状态",prop:"status"}},[a("el-select",{attrs:{placeholder:"请选择状态",filterable:"",clearable:""},model:{value:e.searchForm.status,callback:function(t){e.$set(e.searchForm,"status",t)},expression:"searchForm.status"}},[a("el-option",{attrs:{label:"待质检",value:"0"}}),e._v(" "),a("el-option",{attrs:{label:"质检通过",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"质检未通过",value:"2"}})],1)],1)],1),e._v(" "),a("el-col",{staticClass:"flex-right",attrs:{span:6}},[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.search(t)}}},[e._v("查询")]),e._v(" "),a("el-button",{on:{click:function(t){return e.resetForm("searchForm")}}},[e._v("重置")])],1)],1)],1)},staticRenderFns:[]}},aWSc:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("HzJ8"),s=a.n(r),o=a("rVsN"),i=a.n(o),n=a("4YfN"),l=a.n(n),c=a("ryJa"),u=a.n(c),d=a("dF+P"),m=a("Jky9"),h=a("Jns3"),p=a("0+j4"),g=a("aIe1"),f=a("aobX"),b=a("szpI"),v=a("4+6g"),y=a("fBur"),w=(a("bJK+"),a("I8tE")),F={name:"QualityManagement",mixins:[d.a],components:{NavButton:m.a,NavPremissonButton:h.a,CommonWrapper:p.a,CommonTable:g.a,QualityManagementSearch:f.default,qualityDealFail:b.default},data:function(){return{comp:this,buttonData:[],tableData:[],selectRow:[],StatusTrueflag:!1,StatusFalseflag:!1,isListLoading:!1,orgnization:[],maintainList:[],warehouseList:this.$store.getters.warehouseList,merchantsList:[],originList:[],isFailVisible:!1,modifyUser:null,choosedIds:"",pagination:{pageNum:1,pageSize:10,total:0},searchParams:{}}},activated:function(){this.$refs.userTable.doLayout()},mounted:function(){var e=this;Object(v.g)().then(function(t){e.orgnization=t}),this.getMaintain(),this.getOrigin()},methods:{queryList:function(e){var t=this.searchParams=e;this.getUsers(l()({},t,{pageNum:this.pagination.pageNum,pageSize:this.pagination.pageSize}))},getMaintain:function(){this.maintainList=[{id:"1",name:"返厂",des:"描述",disabled:!1,rechargeable:!1},{id:"2",name:"第三方维修",des:"描述",disabled:!1,rechargeable:!1},{id:"3",name:"星和宅配维修",des:"描述",disabled:!1,rechargeable:!0},{id:"0",name:"继续出库",des:"描述",disabled:!1,rechargeable:!1}]},getMerchantsList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{warehouseUuid:Object(y.b)("warehouseUuid")?Object(y.b)("warehouseUuid"):this.warehouseList[0].warehouseUuid,userUuid:""};return new i.a(function(a){Object(v.f)(t).then(function(t){t.error||(e.merchantsList=t,a())})})},getWarehouse:function(){var e=this;Object(w.n)().then(function(t){console.info("warehouse=>",t),e.warehouseList=t})},getOrigin:function(){this.originList=[{id:"1",name:"入库质检",des:"描述",disabled:!1,rechargeable:!1},{id:"2",name:"出库质检",des:"描述",disabled:!1,rechargeable:!1},{id:"3",name:"维修质检",des:"描述",disabled:!1,rechargeable:!0}]},getUsers:function(e){var t=this;this.isListLoading=!0,Object(w.t)(e).then(function(a){if(0==a.item.length&&a.pageNum>1)return t.pagination.pageNum=1,e.pageNum=1,void t.getUsers(e);t.tableData=a.item,t.pagination.total=a.total,t.pagination.pageNum=a.pageNum,t.pagination.pageSize=a.pageSize,t.isListLoading=!1})},rest:function(e){var t=this.searchParams=e;this.getUsers(l()({},t,{pageNum:1,pageSize:this.pagination.pageSize}))},handleSelectionChange:function(e){var t=this;this.selectRow=e,this.StatusTrueflag=!1;var a=[];this.choosedIds=this.selectRow.map(function(e){0!=e.goodTestStatus&&(t.StatusTrueflag=!0),a.push(e.id)}).join(",")},isButtonIsDisabled:function(){return console.log(this.selectRow.length>0&&!this.StatusTrueflag),!(this.selectRow.length>0&&!this.StatusTrueflag)},handleFail:function(){this.selectRow.length||this.$message({type:"warning",message:"请至少选择一项"}),this.isFailVisible=!0},handleStatus:function(){var e=this;console.log(this.StatusTrueflag,this.selectRow),this.selectRow.length?this.StatusTrueflag?this.$message({message:"所选择项中有已通过质检的数据，请重新选择！",type:"warning"}):this.$confirm("确认要将选择项通过质检么?","提示",{type:"warning"}).then(function(){var t=e.searchParams,a={goodTestStatus:1,goodTestRemark:t.goodTestRemark,goodRepairCost:t.goodRepairCost,goodTestItems:[]},r=!0,o=!1,i=void 0;try{for(var n,l=s()(e.selectRow);!(r=(n=l.next()).done);r=!0){var c=n.value;console.log(e.selectRow),a.goodTestItems.push({goodTestUuid:c.goodTestUuid,productSeq:c.productSeq})}}catch(e){o=!0,i=e}finally{try{!r&&l.return&&l.return()}finally{if(o)throw i}}Object(w.u)(a).then(function(t){console.log(t),t.error||(e.$message({message:"质检通过成功",type:"success"}),e.queryList(e.searchParams))})}).catch(function(){console.log("111")}):this.$message({type:"warning",message:"请至少选择一项"})},isButtonDisabled:function(){return!!this.selectRow.length},formatState:function(e,t){switch(e.goodTestStatus){case"0":return"待质检";case"1":return"质检通过";case"2":return"质检未通过"}},formatDate:function(e){if(e.testEndDate)return u()(e.testEndDate).utcOffset(8).format("YYYY-MM-DD HH:mm:ss")},formatType:function(e,t){switch(e.goodTestType){case"1":return"入库质检";case"2":return"出库质检";case"3":return"维修质检"}},formatCreateDate:function(e){return u()(e.userCreateTime).utcOffset(8).format("YYYY-MM-DD")},typeFormatter:function(e){switch(e.productType){case"0":return"小件";case"1":return"套件";case"2":return"单品";default:return"未知"}},getUserDetail:function(e,t){},changePage:function(e){this.pagination.pageNum=e,this.queryList(this.searchParams)},indexMethod:function(e){return e+1+(this.pagination.pageNum-1)*this.pagination.pageSize}}},_=a("grX7"),U=a.n(_),L=a("C7Lr")(F,U.a,!1,null,null,null);t.default=L.exports},aobX:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("aA9S"),s=a.n(r),o=(a("I8tE"),a("4+6g"),a("fBur")),i=a("ryJa"),n=a.n(i),l={name:"QualityManagementSearch",data:function(){return{searchForm:{inventoryUuid:"",warehouseUuid:"",productTempleteUuid:"",orderUuid:"",storageUuid:"",createUserUuid:"",createTimeBegin:"",createTimeEnd:"",merchantUuid:"",testFrom:"",beginDate:"",endDate:"",status:"",orderId:"",testForm:"",timeRange:[]}}},props:{warehouseList:{type:Array,required:!0},originList:{type:Array,required:!0},merchantsList:{type:Array,required:!0}},mounted:function(){this.searchForm.warehouseUuid=Object(o.b)("warehouseUuid"),this.search(),this.getMerchantsList(this.searchForm.warehouseUuid)},methods:{getMerchantsList:function(e){Object(o.e)("warehouseUuid",e),this.searchForm.merchantUuid="",this.$emit("getMerchants",s()({},this.searchForm))},search:function(){this.searchForm.endDate&&this.searchForm.beginDate&&(n()(this.searchForm.endDate).isBefore(this.searchForm.beginDate)||n()(this.searchForm.endDate).isSame(this.searchForm.beginDate))?(this.$message({message:"结束日期不能早于开始日期，请重新选择！",type:"warning"}),this.searchForm.endDate=null):this.$emit("search",s()({},this.searchForm))},closeSearch:function(e){this.$emit("closeSearch")},resetForm:function(e){this.$refs[e].resetFields(),this.searchForm.warehouseUuid=Object(o.b)("warehouseUuid"),this.$emit("rest",s()({},this.searchForm))}}},c=a("7g4z"),u=a.n(c);var d=function(e){a("kpIs")},m=a("C7Lr")(l,u.a,!1,d,"data-v-d3a207a6",null);t.default=m.exports},etky:function(e,t){},grX7:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("common-wrapper",[a("quality-management-search",{staticClass:"search",attrs:{originList:e.originList,merchantsList:e.merchantsList,warehouseList:e.warehouseList},on:{getMerchants:e.getMerchantsList,search:e.queryList,rest:e.rest}})],1),e._v(" "),a("nav-button",[a("el-button-group",[a("el-button",{attrs:{icon:"fdddfont icon-add-new",disabled:e.isButtonIsDisabled()},on:{click:e.handleStatus}},[e._v("质检通过")]),e._v(" "),a("el-button",{attrs:{icon:"fdddfont icon-shouquan",disabled:e.isButtonIsDisabled()},on:{click:e.handleFail}},[e._v("质检不通过")])],1),e._v(" "),e.StatusTrueflag?a("span",{staticStyle:{color:"red"}},[e._v("仅待质检的数据可以继续操作，请取消勾选！")]):e._e()],1),e._v(" "),a("common-wrapper",[a("common-table",{attrs:{flex:270}},[a("template",{slot:"table"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.isListLoading,expression:"isListLoading"}],ref:"userTable",attrs:{height:"100%",stripe:"",border:!0,"tooltip-effect":"light",data:e.tableData},on:{"row-click":e.getUserDetail,"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"30"}}),e._v(" "),a("el-table-column",{attrs:{type:"index",index:e.indexMethod,label:"序号",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{sortable:"",prop:"productUuid",label:"货品编号",width:"160"}}),e._v(" "),a("el-table-column",{attrs:{sortable:"",prop:"orderUuid",label:"收货单号",width:"160"}}),e._v(" "),a("el-table-column",{attrs:{sortable:"",prop:"merchantName",label:"商户",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{sortable:"",prop:"productSeq",label:"条码",width:"170"}}),e._v(" "),a("el-table-column",{attrs:{sortable:"",prop:"productName",label:"货品名称",width:"120","show-tooltip-when-overflow":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"productModel",label:"型号","min-width":"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"productColor",label:"颜色"}}),e._v(" "),a("el-table-column",{attrs:{prop:"productType",label:"货品类型",formatter:e.typeFormatter}}),e._v(" "),a("el-table-column",{attrs:{prop:"goodTestStatus",label:"状态",width:"80",formatter:e.formatState}}),e._v(" "),a("el-table-column",{attrs:{prop:"testEndDate",label:"质检时间",width:"150",formatter:e.formatDate}}),e._v(" "),a("el-table-column",{attrs:{prop:"goodTestType",label:"质检来源",width:"120",formatter:e.formatType}}),e._v(" "),a("el-table-column",{attrs:{sortable:"",prop:"warehouseName",label:"仓库",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"goodTestRemark",label:"备注/质检不通过的原因","show-overflow-tooltip":!0,"min-width":"120"}})],1)],1),e._v(" "),a("template",{slot:"pagination"},[a("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next","current-page":e.pagination.pageNum,"page-size":e.pagination.pageSize,total:e.pagination.total},on:{"update:currentPage":function(t){return e.$set(e.pagination,"pageNum",t)},"update:current-page":function(t){return e.$set(e.pagination,"pageNum",t)},"current-change":e.changePage}})],1)],2)],1),e._v(" "),a("quality-deal-fail",{attrs:{show:e.isFailVisible,modifyUser:e.selectRow,searchParams:e.searchParams,methods:e.maintainList,ids:e.choosedIds},on:{"update:show":function(t){e.isFailVisible=t},"update:modifyUser":function(t){e.selectRow=t},"update:modify-user":function(t){e.selectRow=t},updateList:e.queryList}})],1)},staticRenderFns:[]}},kpIs:function(e,t){},p6r4:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{width:"600px",visible:e.isVisible,"close-on-click-modal":!1,"close-on-press-escape":!1,title:"请选择质检不通过后的维修方案：",center:""},on:{"update:visible":function(t){e.isVisible=t},close:e.cancel}},[a("el-form",{ref:"qualityForm",attrs:{model:e.qualityForm,rules:e.formRules,"label-width":"30px"}},[a("el-form-item",{attrs:{label:"",prop:"methods"}},[a("el-radio-group",{model:{value:e.qualityForm.methods,callback:function(t){e.$set(e.qualityForm,"methods",t)},expression:"qualityForm.methods"}},e._l(e.methods,function(t,r){return a("el-row",{key:r},[a("el-col",{attrs:{span:8}},[a("el-radio",{attrs:{label:t.id,value:t.id}},[e._v(e._s(t.name))])],1),e._v(" "),t.rechargeable&&e.qualityForm.methods==t.id?a("el-col",{attrs:{span:16}},[a("el-form-item",{attrs:{label:"维修价格","label-width":"80px",prop:"price"}},[a("el-input-number",{attrs:{"controls-position":"right",min:1,max:999999,precision:2,step:.01,size:"mini"},model:{value:e.qualityForm.price,callback:function(t){e.$set(e.qualityForm,"price",t)},expression:"qualityForm.price"}})],1)],1):e._e()],1)}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"",prop:"goodTestRemark"}},[a("span",[e._v("质检不通过的原因:")]),e._v(" "),a("el-input",{attrs:{rows:5,type:"textarea",maxlength:"200",placeholder:"请输入质检不通过的原因,最长200字符",resize:"none"},model:{value:e.qualityForm.goodTestRemark,callback:function(t){e.$set(e.qualityForm,"goodTestRemark",t)},expression:"qualityForm.goodTestRemark"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.save}},[e._v("提交")]),e._v(" "),a("el-button",{attrs:{size:"small"},on:{click:e.cancel}},[e._v("取消")])],1)],1)},staticRenderFns:[]}},szpI:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("HzJ8"),s=a.n(r),o=a("uTPb"),i=a("I8tE"),n={name:"QualityDealFail",data:function(){return{isVisible:!1,qualityForm:{methods:"",price:"",goodTestRemark:""},formRules:{price:[{required:!0,message:"请输入价格",trigger:"change"},{validator:o.a.normalNumber,trigger:"change"}],methods:[{required:!0,message:"请选择维修方式",trigger:"change"}]}}},props:{show:{type:Boolean,default:!1},modifyUser:{type:Array},searchParams:{type:Object},methods:{type:Array,required:!0},ids:{type:String,required:!0}},watch:{show:function(e){this.isVisible=e}},methods:{save:function(){var e=this;this.$refs.qualityForm.validate(function(t){if(t){e.searchParams;var a={goodTestStatus:2,goodTestResult:e.qualityForm.methods,goodTestRemark:e.qualityForm.goodTestRemark,goodRepairCost:e.qualityForm.price,goodTestItems:[]},r=!0,o=!1,n=void 0;try{for(var l,c=s()(e.modifyUser);!(r=(l=c.next()).done);r=!0){var u=l.value;a.goodTestItems.push({goodTestUuid:u.goodTestUuid,productSeq:u.productSeq})}}catch(e){o=!0,n=e}finally{try{!r&&c.return&&c.return()}finally{if(o)throw n}}Object(i.u)(a).then(function(t){t.error||(e.$message({message:"修改维修方式成功!",type:"success"}),e.cancel(),e.$emit("updateList",e.searchParams))})}})},cancel:function(){this.$refs.qualityForm.resetFields(),this.$emit("update:show",!1),this.isVisible=!1}}},l=a("p6r4"),c=a.n(l);var u=function(e){a("etky")},d=a("C7Lr")(n,c.a,!1,u,"data-v-fb11f704",null);t.default=d.exports}});
//# sourceMappingURL=20.c9dc8145cd57f2ff3234.js.map