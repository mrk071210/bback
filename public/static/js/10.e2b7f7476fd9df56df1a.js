webpackJsonp([10,55,77,96,129],{"/6Io":function(e,t){},"4hyV":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("aA9S"),r=a.n(o),l={name:"RoleManagementSearch",data:function(){return{searchForm:{rolesName:"",rolesEnable:"",rolesRemark:""}}},mounted:function(){this.search()},methods:{search:function(){this.$emit("search",r()({},this.searchForm))},resetForm:function(e){this.$refs[e].resetFields(),this.$emit("rest",r()({},this.searchForm))}}},n=a("Qsx1"),i=a.n(n);var s=function(e){a("/6Io")},c=a("C7Lr")(l,i.a,!1,s,"data-v-aca8d32e",null);t.default=c.exports},"5JbS":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("4YfN"),r=a.n(o),l=a("ryJa"),n=a.n(l),i=a("dF+P"),s=a("Jky9"),c=a("Jns3"),u=a("0+j4"),d=a("aIe1"),h=a("4hyV"),p=a("mDSS"),m=a("mRmE"),f=a("bpT1"),b=a("baPR"),g={name:"RoleManagement",mixins:[i.a],data:function(){return{comp:this,buttonData:[],tableData:[],selectRow:[],editRole:{},isShowRoleDialog:!1,isShowRoleLineDialog:!1,isShowRoleMenuDialog:!1,isListLoading:!1,isCreate:!0,pagination:{pageNum:1,pageSize:10,total:0},searchParams:{}}},activated:function(){this.$refs.roleTable.doLayout()},mounted:function(){},methods:{queryList:function(e){var t=this.searchParams=e;this.getRoles(r()({},t,{pageNum:this.pagination.pageNum,pageSize:this.pagination.pageSize}))},isButtonIsDisabled:function(){return!!this.selectRow.length},getRoles:function(e){var t=this;this.isListLoading=!0,Object(b.c)(e).then(function(a){if(!a.error){if(0==a.item.length&&a.pageNum>1)return t.pagination.pageNum=1,e.pageNum=1,void t.getRoles(e);t.tableData=a.item,t.pagination.total=a.total,t.pagination.pageNum=a.pageNum,t.pagination.pageSize=a.pageSize,t.isListLoading=!1}})},rest:function(e){var t=this.searchParams=e;this.getRoles(r()({},t,{pageNum:1,pageSize:this.pagination.pageSize}))},handleEdit:function(e,t){this.isCreate=!1,this.editRole=t,this.isShowRoleDialog=!0},handleAdd:function(){this.isCreate=!0,this.isShowRoleDialog=!0},menuAuth:function(e,t){this.editRole=t,this.isShowRoleMenuDialog=!0},lineAuth:function(e,t){this.editRole=t,this.isShowRoleLineDialog=!0},handleDel:function(e,t){var a=this;this.$confirm("确认删除该角色吗?","提示",{type:"warning"}).then(function(){var e={roleUuid:t.roleUuid};a.deleteRoles(e)}).catch(function(){})},batchRemove:function(){var e=this;this.$confirm("确认删除选中的角色吗？","提示",{type:"warning"}).then(function(){var t=[];e.selectRow.map(function(e){return t.push(e.rolesUuid)}),e.isListLoading=!0,e.deleteRoles(t).then(function(){e.isListLoading=!1})}).catch(function(){})},deleteRoles:function(e){var t=this;return Object(b.b)(e).then(function(e){e.error||(t.$message({message:"删除成功",type:"success"}),t.queryList(t.searchParams))})},changePage:function(e){this.pagination.pageNum=e,this.queryList(this.searchParams)},indexMethod:function(e){return e+1+(this.pagination.pageNum-1)*this.pagination.pageSize},formatStatus:function(e){return 1===e.roleEnable?"启用":0===e.roleEnable?"禁用":"未知"},formatCreateDate:function(e){return n()(e.roleCreateTime).format("YYYY-MM-DD")}},components:{NavButton:s.a,NavPremissonButton:c.a,CommonWrapper:u.a,CommonTable:d.a,RoleManagementSearch:h.default,RoleUpdate:p.default,RoleLineRes:m.default,RoleMenuRes:f.default}},v=a("8imF"),R=a.n(v),k=a("C7Lr")(g,R.a,!1,null,null,null);t.default=k.exports},"8imF":function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("nav-button",[a("el-button-group",[a("el-button",{attrs:{icon:"fdddfont icon-add-new"},on:{click:e.handleAdd}},[e._v("新增")])],1)],1),e._v(" "),a("common-wrapper",[a("role-management-search",{staticClass:"search",on:{search:e.queryList,rest:e.rest}})],1),e._v(" "),a("common-wrapper",[a("common-table",{attrs:{flex:230}},[a("template",{slot:"table"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.isListLoading,expression:"isListLoading"}],ref:"roleTable",attrs:{height:"100%",stripe:"",border:!0,"tooltip-effect":"light",data:e.tableData},on:{"selection-change":function(t){return e.selectRow=t}}},[a("el-table-column",{attrs:{type:"index",index:e.indexMethod,label:"序号",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{sortable:"",prop:"roleName",label:"角色名称",width:"130"}}),e._v(" "),a("el-table-column",{attrs:{prop:"roleEnable",label:"状态",formatter:e.formatStatus,width:"80"}}),e._v(" "),a("el-table-column",{attrs:{sortable:"",prop:"roleCreateTime",label:"创建时间",formatter:e.formatCreateDate,width:"150"}}),e._v(" "),a("el-table-column",{attrs:{prop:"roleRemark",label:"角色描述","min-width":"150","show-tooltip-when-overflow":!0}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"190"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"light",content:"菜单授权",placement:"bottom"}},[a("el-button",{attrs:{size:"mini",round:"",icon:"fdddfont icon-shouquan"},on:{click:function(a){return a.stopPropagation(),e.menuAuth(t.$index,t.row)}}})],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"light",content:"编辑",placement:"bottom"}},[a("el-button",{attrs:{size:"mini",round:"",icon:"fdddfont icon-modify"},on:{click:function(a){return a.stopPropagation(),e.handleEdit(t.$index,t.row)}}})],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"light",content:"删除",placement:"bottom"}},[a("el-button",{attrs:{size:"mini",round:"",icon:"fdddfont icon-delete"},on:{click:function(a){return a.stopPropagation(),e.handleDel(t.$index,t.row)}}})],1)]}}])})],1)],1),e._v(" "),a("template",{slot:"pagination"},[a("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next","current-page":e.pagination.pageNum,"page-size":e.pagination.pageSize,total:e.pagination.total},on:{"update:currentPage":function(t){return e.$set(e.pagination,"pageNum",t)},"update:current-page":function(t){return e.$set(e.pagination,"pageNum",t)},"current-change":e.changePage}})],1)],2)],1),e._v(" "),a("role-update",{attrs:{show:e.isShowRoleDialog,roleData:e.editRole,isCreate:e.isCreate,searchParams:e.searchParams},on:{"update:show":function(t){e.isShowRoleDialog=t},"update:roleData":function(t){e.editRole=t},"update:role-data":function(t){e.editRole=t},updateList:e.queryList}}),e._v(" "),a("role-menu-res",{attrs:{show:e.isShowRoleMenuDialog,roleData:e.editRole,searchParams:e.searchParams},on:{"update:show":function(t){e.isShowRoleMenuDialog=t},"update:roleData":function(t){e.editRole=t},"update:role-data":function(t){e.editRole=t},updateList:e.queryList}}),e._v(" "),a("role-line-res",{attrs:{show:e.isShowRoleLineDialog,roleData:e.editRole},on:{"update:show":function(t){e.isShowRoleLineDialog=t},"update:roleData":function(t){e.editRole=t},"update:role-data":function(t){e.editRole=t},updateList:e.queryList}})],1)},staticRenderFns:[]}},HHPP:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{width:"600px",title:"菜单授权",visible:e.isVisible},on:{close:e.cancel}},[a("div",{staticClass:"tree-content"},[a("el-tree",{ref:"tree",attrs:{data:e.treeData,"node-key":"id",props:e.defaultProps,"show-checkbox":!0,"default-checked-keys":e.checkedNodes,"default-expanded-keys":e.expandNodes},on:{check:e.handleCheckNode}})],1),e._v(" "),a("template",{staticClass:"flex-right",slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("保存")]),e._v(" "),a("el-button",{on:{click:e.cancel}},[e._v("取消")])],1)],2)},staticRenderFns:[]}},Qsx1:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"searchForm",attrs:{model:e.searchForm,"label-width":"80px"}},[a("el-row",[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"角色名称",prop:"rolesName"}},[a("el-input",{attrs:{clearable:""},model:{value:e.searchForm.rolesName,callback:function(t){e.$set(e.searchForm,"rolesName",t)},expression:"searchForm.rolesName"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"状态",prop:"rolesEnable"}},[a("el-select",{attrs:{filterable:"",clearable:""},model:{value:e.searchForm.rolesEnable,callback:function(t){e.$set(e.searchForm,"rolesEnable",t)},expression:"searchForm.rolesEnable"}},[a("el-option",{staticClass:"radio",attrs:{value:"1",label:"启用"}}),e._v(" "),a("el-option",{staticClass:"radio",attrs:{value:"0",label:"禁用"}})],1)],1)],1),e._v(" "),a("el-col",{staticClass:"flex-right",attrs:{span:6}},[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.search(t)}}},[e._v("查询")]),e._v(" "),a("el-button",{on:{click:function(t){return e.resetForm("searchForm")}}},[e._v("重置")])],1)],1)],1)},staticRenderFns:[]}},TXIJ:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{width:"600px",title:(e.isCreate?"新增":"编辑")+"角色",visible:e.isVisible,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.isVisible=t},close:e.cancel}},[a("el-form",{ref:"roleForm",attrs:{model:e.roleForm,rules:e.formRules,"label-width":"80px"}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"角色名称",prop:"roleName"}},[a("el-input",{attrs:{maxlength:"50"},model:{value:e.roleForm.roleName,callback:function(t){e.$set(e.roleForm,"roleName",t)},expression:"roleForm.roleName"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"类型",prop:"roleType"}},[a("el-select",{attrs:{placeholder:"请选择角色类型"},model:{value:e.roleForm.roleType,callback:function(t){e.$set(e.roleForm,"roleType",t)},expression:"roleForm.roleType"}},e._l(e.roleTypeList,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"状态",prop:"roleEnable"}},[a("el-radio-group",{model:{value:e.roleForm.roleEnable,callback:function(t){e.$set(e.roleForm,"roleEnable",t)},expression:"roleForm.roleEnable"}},[a("el-radio",{attrs:{label:1}},[e._v("启用")]),e._v(" "),a("el-radio",{attrs:{label:0}},[e._v("禁用")])],1)],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"角色描述",prop:"roleRemark"}},[a("el-input",{attrs:{type:"textarea",rows:2,maxlength:"200",placeholder:"请输入角色描述，最长200字符"},model:{value:e.roleForm.roleRemark,callback:function(t){e.$set(e.roleForm,"roleRemark",t)},expression:"roleForm.roleRemark"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:6,offset:18}},[a("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("保存")]),e._v(" "),a("el-button",{on:{click:e.cancel}},[e._v("取消")])],1)],1)],1)],1)},staticRenderFns:[]}},"ae+L":function(e,t){},bpT1:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("IYkF"),r=a.n(o),l=a("HzJ8"),n=a.n(l),i=a("QPLA"),s=a("baPR"),c={name:"RoleMenuRes",data:function(){return{isVisible:!1,treeData:[],originalTreeData:null,checkedNodes:[],expandNodes:[],defaultProps:{label:"name"}}},props:{show:{type:Boolean,required:!0},roleData:{type:Object,required:!0},searchParams:{type:Object}},watch:{show:function(e){e&&this.initLineTree(),this.isVisible=e}},methods:{initLineTree:function(){var e=this;this.checkedNodes=[],this.originalTreeData=[],this.treeData=[];var t=this.roleData.roleUuid;Object(s.f)({roleParentId:t}).then(function(t){e.originalTreeData=t,e.treeData=Object(i.a)(t);var a=[],o=[];t.forEach(function(t){""===t.pId&&e.expandNodes.push(t.id),!0===t.checked&&a.push(t)});var r=e.getOnlyChildrenNodes(a),l=!0,s=!1,c=void 0;try{for(var u,d=n()(r);!(l=(u=d.next()).done);l=!0){var h=u.value;o.push(h.id)}}catch(e){s=!0,c=e}finally{try{!l&&d.return&&d.return()}finally{if(s)throw c}}e.$refs.tree.setCheckedKeys(o,!0)}).then(function(){})},getOnlyChildrenNodes:function(e){return e.filter(function(e){return!e.children.length})},handleCheckNode:function(e,t,a){var o=this.$refs.tree.getCheckedKeys(),r=this.$refs.tree.getHalfCheckedKeys(),l=o.concat(r);this.checkedNodes=l},save:function(){var e=this;this.handleCheckNode();var t={roleResourceRoleId:this.roleData.roleUuid,roleResourceResourceId:this.checkedNodes.join(",")};Object(s.i)(t).then(function(t){e.$message({message:"菜单授权成功!",type:"success"}),e.$emit("updateList",e.searchParams),e.cancel()})},cancel:function(){this.$emit("update:show",!1),this.$emit("update:roleData",r()(null)),this.isVisible=!1}}},u=a("HHPP"),d=a.n(u);var h=function(e){a("hGc0")},p=a("C7Lr")(c,d.a,!1,h,"data-v-64c2ef51",null);t.default=p.exports},hGc0:function(e,t){},kIbC:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{width:"600px",title:"线路授权",visible:e.isVisible},on:{close:e.cancel}},[a("div",{staticClass:"tree-content"},[a("el-tree",{ref:"tree",attrs:{data:e.treeData,"node-key":"id",props:e.defaultProps,"show-checkbox":"","default-checked-keys":e.checkedNodes,"default-expanded-keys":e.expandNodes},on:{"check-change":e.handleCheckNode}})],1),e._v(" "),a("template",{staticClass:"flex-right",slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("保存")]),e._v(" "),a("el-button",{on:{click:e.cancel}},[e._v("取消")])],1)],2)},staticRenderFns:[]}},mDSS:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("IYkF"),r=a.n(o),l=a("aA9S"),n=a.n(l),i=a("baPR"),s={roleName:"",roleEnable:1,roleRemark:"",roleType:""},c={name:"RoleUpdate",data:function(){return{isVisible:!1,roleForm:n()({},s),formRules:{roleName:[{required:!0,message:"请输入角色名称",trigger:"change"},{min:1,max:20,message:"长度在 1 到 20 个字符",trigger:"change"}],roleRemark:[{min:1,max:200,message:"长度在 1 到 200 个字符",trigger:"change"}],roleType:[{required:!0,message:"请选择角色类型",trigger:"change"}],roleEnable:[{required:!0,message:"请选择角色状态",trigger:"change"}]},roleTypeList:[{value:"0",label:"系统管理员"},{value:"1",label:"商户"},{value:"2",label:"仓库管理员"},{value:"3",label:"财务管理员"},{value:"5",label:"调度管理员"},{value:"6",label:"配送管理员"},{value:"7",label:"司机"},{value:"11",label:"安装工"},{value:"9",label:"财务"},{value:"8",label:"项目总监"},{value:"12",label:"供应商"},{value:"13",label:"维修工"},{value:"14",label:"客服"},{value:"15",label:"合伙人"},{value:"16",label:"中心总"},{value:"17",label:"招商"}]}},props:{show:{type:Boolean,default:!1},roleData:{type:Object},isCreate:{type:Boolean,required:!0},searchParams:{type:Object}},watch:{show:function(e){e&&(this.isCreate?this.roleForm=n()({},s):this.roleForm=n()({},this.roleData)),this.isVisible=e}},methods:{save:function(){var e=this;this.$refs.roleForm.validate(function(t){if(t){var a=n()({},e.roleForm),o=e.isCreate?i.a:i.g,r=e.isCreate?"新增":"编辑";o(a).then(function(t){e.$message({message:r+"角色成功!",type:"success"}),e.cancel(),e.$emit("updateList",e.searchParams)})}})},cancel:function(){this.roleForm=n()({},s),this.$refs.roleForm.resetFields(),this.$emit("update:show",!1),this.$emit("update:roleData",r()(null)),this.isVisible=!1}}},u=a("TXIJ"),d=a.n(u),h=a("C7Lr")(c,d.a,!1,null,null,null);t.default=h.exports},mRmE:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("IYkF"),r=a.n(o),l=a("QPLA"),n=a("baPR"),i={name:"RoleLineRes",data:function(){return{isVisible:!1,treeData:[],checkedNodes:[],expandNodes:[],defaultProps:{label:"name"}}},props:{show:{type:Boolean,required:!0},roleData:{type:Object,required:!0}},watch:{show:function(e){e&&this.initLineTree(),this.isVisible=e}},methods:{initLineTree:function(){var e=this,t=this.roleData.roleParentId;Object(n.e)({roleParentId:t}).then(function(t){e.treeData=Object(l.a)(t),t.forEach(function(t){""===t.pId&&e.expandNodes.push(t.id)})}).then(function(){var t=e.roleData.roleUuid;Object(n.d)({roleUuid:t}).then(function(t){t&&t.length?e.checkedNodes=t:e.checkedNodes=[],e.$refs.tree.setCheckedKeys(e.checkedNodes)})})},handleCheckNode:function(e,t,a){},getCheckdNodesArr:function(e){var t=[];return e.forEach(function(e){"LINE"===e.levelsType&&t.push(e.id)}),t},save:function(){var e=this,t=this.$refs.tree.getCheckedNodes(),a=this.getCheckdNodesArr(t),o={roleList:[this.roleData.rolesUuid],lineArr:a};console.log("parmas",o),Object(n.h)(o).then(function(t){e.$message({message:"授权线路成功!",type:"success"}),e.$emit("updateList"),e.cancel()})},cancel:function(){this.$emit("update:show",!1),this.$emit("update:roleData",r()(null)),this.isVisible=!1}}},s=a("kIbC"),c=a.n(s);var u=function(e){a("ae+L")},d=a("C7Lr")(i,c.a,!1,u,"data-v-3d509722",null);t.default=d.exports}});
//# sourceMappingURL=10.e2b7f7476fd9df56df1a.js.map