webpackJsonp([27,103,141],{DHZZ:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("rVsN"),i=a.n(o),n=a("4YfN"),l=a.n(n),s=a("ryJa"),r=a.n(s),c=a("dF+P"),d=a("Jky9"),u=a("Jns3"),p=a("0+j4"),m=a("aIe1"),v=a("erbJ"),h=a("ZVJP"),f=a("aQ5O"),b=a("8ZKe"),g=a("X2t0"),w=a("z7pT"),_={name:"DeviceManagement",mixins:[c.a],data:function(){return{comp:this,buttonData:[],tableData:[],selectRow:[],editRole:{},isShowRoleDialog:!1,isListLoading:!1,isCreate:!0,showUpload:!1,uploadFileUrl:"/excel/uploadFile",limit:1,size:.5,acceptType:".xls",pojo:"TDevice",isShowDown:!0,isHasToken:!0,showUploadTable:!1,uploadData:{},pagination:{pageNum:1,pageSize:10,total:0},searchParams:{}}},activated:function(){this.$refs.roleTable.doLayout()},mounted:function(){},methods:{queryList:function(e){var t=this.searchParams=e;this.getRoles(l()({},t,{pageNum:this.pagination.pageNum,pageSize:this.pagination.pageSize}))},getRoles:function(e){var t=this;this.isListLoading=!0,Object(w.j)(e).then(function(e){t.tableData=e.list,t.pagination.total=e.total,t.pagination.pageNum=e.pageNum,t.pagination.pageSize=e.pageSize,t.isListLoading=!1})},rest:function(e){var t=this.searchParams=e;this.getRoles(l()({},t,{pageNum:1,pageSize:this.pagination.pageSize}))},changePage:function(e){this.pagination.pageNum=e,this.queryList(this.searchParams)},indexMethod:function(e){return e+1+(this.pagination.pageNum-1)*this.pagination.pageSize},formatCreateDate:function(e){if(e.devUpdateTime)return r()(e.devUpdateTime).utcOffset(8).format("YYYY-MM-DD HH:mm:ss")},isButtonDisabled:function(){return!!this.selectRow.length},handleAdd:function(){this.isCreate=!0,this.isShowRoleDialog=!0},handleEdit:function(e,t){this.isCreate=!1,this.editRole=t,this.isShowRoleDialog=!0},deleteDevices:function(e){var t=this;return Object(w.g)(e).then(function(e){e.error||(t.$message({message:"删除成功",type:"success"}),t.queryList())})},batchRemove:function(){var e=this;this.$confirm("确认删除选中的设备吗？","提示",{type:"warning"}).then(function(){var t=[];e.selectRow.map(function(e){return t.push(e.devUuid)}),e.isListLoading=!0,e.deleteDevices(t).then(function(){e.isListLoading=!1}).catch(function(){})})},handleDel:function(e,t){var a=this;this.$confirm("确认删除该设备吗?","提示",{type:"warning"}).then(function(){a.deleteDevices([t.devUuid])}).catch(function(){})},exportsLog:function(){this.$nextPage({title:"导入日志查看",props:{modelName:"设备信息批量导入"},component:g.default,cache:!0})},validDevice:function(e,t){var a=this,o="0"===t.devIsvalid?"启用":"禁用";this.$confirm("确认状态修改为"+o+"?","提示",{type:"warning"}).then(function(){var e={devUuid:t.devUuid,devIsvalid:t.devIsvalid};Object(w.m)(e).then(function(e){console.log(e),a.queryList()})}).catch(function(){})},exportsFile:function(){this.showUpload=!0},getUploadData:function(e){var t=this;setTimeout(function(){t.showUploadTable=!0},500),new i.a(function(t,a){t(e)}).then(function(e){t.uploadData=e})}},components:{NavButton:d.a,NavPremissonButton:u.a,CommonWrapper:p.a,CommonTable:m.a,DeviceManagementSearch:v.default,DeviceUpdate:h.default,UploadFile:f.default,UploadFileTable:b.default}},F=a("nYfD"),S=a.n(F),D=a("C7Lr")(_,S.a,!1,null,null,null);t.default=D.exports},"Gt/v":function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{width:"700px",title:(e.isCreate?"新增":"编辑")+"设备信息",visible:e.isVisible,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.isVisible=t},close:e.cancel}},[a("el-form",{ref:"deviceForm",attrs:{model:e.deviceForm,rules:e.formRules,"label-width":"110px"}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"设备编号",prop:"devCode"}},[a("el-input",{attrs:{placeholder:"请输入设备编号"},model:{value:e.deviceForm.devCode,callback:function(t){e.$set(e.deviceForm,"devCode",t)},expression:"deviceForm.devCode"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"SIM卡号",prop:"devSimNum"}},[a("el-input",{attrs:{placeholder:"请输入SIM卡号"},model:{value:e.deviceForm.devSimNum,callback:function(t){e.$set(e.deviceForm,"devSimNum",t)},expression:"deviceForm.devSimNum"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"型号",prop:"devModelNum"}},[a("el-input",{attrs:{placeholder:"请输入型号"},model:{value:e.deviceForm.devModelNum,callback:function(t){e.$set(e.deviceForm,"devModelNum",t)},expression:"deviceForm.devModelNum"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"版本",prop:"devVersion"}},[a("el-input",{attrs:{placeholder:"请输入版本"},model:{value:e.deviceForm.devVersion,callback:function(t){e.$set(e.deviceForm,"devVersion",t)},expression:"deviceForm.devVersion"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"设备电话",prop:"devPhone"}},[a("el-input",{attrs:{placeholder:"请输入设备电话"},model:{value:e.deviceForm.devPhone,callback:function(t){e.$set(e.deviceForm,"devPhone",t)},expression:"deviceForm.devPhone"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"启禁状态",prop:"devIsvalid"}},[a("el-radio-group",{model:{value:e.deviceForm.devIsvalid,callback:function(t){e.$set(e.deviceForm,"devIsvalid",t)},expression:"deviceForm.devIsvalid"}},[a("el-radio",{attrs:{label:"1"}},[e._v("启用")]),e._v(" "),a("el-radio",{attrs:{label:"0"}},[e._v("禁用")])],1)],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:6,offset:18}},[a("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("保存")]),e._v(" "),a("el-button",{on:{click:e.cancel}},[e._v("取消")])],1)],1)],1)],1)],1)},staticRenderFns:[]}},SLxE:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"searchForm",attrs:{model:e.searchForm,"label-width":"110px"}},[a("el-row",[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"设备编号",prop:"devCode"}},[a("el-input",{attrs:{placeholder:"请输入设备编号"},model:{value:e.searchForm.devCode,callback:function(t){e.$set(e.searchForm,"devCode",t)},expression:"searchForm.devCode"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"车牌号",prop:"busPlateNumber"}},[a("el-input",{attrs:{placeholder:"请输入车牌号"},model:{value:e.searchForm.busPlateNumber,callback:function(t){e.$set(e.searchForm,"busPlateNumber",t)},expression:"searchForm.busPlateNumber"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"车辆自编号",prop:"busSelfCode"}},[a("el-input",{attrs:{placeholder:"请输入车辆自编号"},model:{value:e.searchForm.busSelfCode,callback:function(t){e.$set(e.searchForm,"busSelfCode",t)},expression:"searchForm.busSelfCode"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"在线状态",prop:"devOnlineStatus"}},[a("el-radio-group",{model:{value:e.searchForm.devOnlineStatus,callback:function(t){e.$set(e.searchForm,"devOnlineStatus",t)},expression:"searchForm.devOnlineStatus"}},[a("el-radio",{attrs:{label:0}},[e._v("断开")]),e._v(" "),a("el-radio",{attrs:{label:1}},[e._v("在线")])],1)],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{staticClass:"flex-right",attrs:{span:6,offset:18}},[a("el-form-item",[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.search(t)}}},[e._v("查询")]),e._v(" "),a("el-button",{on:{click:function(t){return e.resetForm("searchForm")}}},[e._v("重置")])],1)],1)],1)],1)},staticRenderFns:[]}},WM7o:function(e,t){},ZVJP:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("aA9S"),i=a.n(o),n=a("z7pT"),l=a("uTPb"),s={devCode:"",devSimNum:"",devModelNum:"",devVersion:"",devPhone:"",devIsvalid:"1"},r={name:"DeviceUpdate",data:function(){return{lineOrgs:[],lines:[],isVisible:!1,deviceForm:i()({},s),formRules:{devCode:[{required:!0,message:"请输入设备编号",trigger:"blur"}],devPhone:[{validator:l.a.cellPhone,message:"手机号应为11位数字",trigger:"blur"}]}}},props:{show:{type:Boolean,default:!1},roleData:{type:Object},isCreate:{type:Boolean,required:!0}},watch:{show:function(e){e&&(this.isCreate?this.deviceForm=i()({},s):this.deviceForm=i()({},this.roleData)),this.isVisible=e}},mounted:function(){},methods:{save:function(){var e=this;this.$refs.deviceForm.validate(function(t){if(t){var a=i()({},e.deviceForm),o=e.isCreate?n.c:n.s,l=e.isCreate?"新增":"编辑";o(a).then(function(t){e.$message({message:l+"设备成功!",type:"success"}),e.cancel(),e.$emit("updateList")})}})},cancel:function(){this.deviceForm=i()({},s),this.$refs.deviceForm.resetFields(),this.$emit("update:show",!1),this.isVisible=!1}}},c=a("Gt/v"),d=a.n(c),u=a("C7Lr")(r,d.a,!1,null,null,null);t.default=u.exports},erbJ:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("aA9S"),i=a.n(o),n=a("ryJa"),l=a.n(n),s={name:"DeviceManagementSearch",data:function(){return{searchForm:{notifyTime:["",""],devCode:"",busPlateNumber:"",busSelfCode:"",devOnlineStatus:"",orderBy:"",descOrAsc:""}}},watch:{},mounted:function(){this.search()},methods:{initTime:function(){var e=l()().subtract(6,"d"),t=l()().subtract(0,"d");this.searchForm.notifyTime=[e,t],this.searchForm.mdStartDate=e,this.searchForm.mdEndDate=t},convertSearchParams:function(){return{devCode:this.searchForm.devCode,busPlateNumber:this.searchForm.busPlateNumber,busSelfCode:this.searchForm.busSelfCode,devOnlineStatus:this.searchForm.devOnlineStatus}},search:function(){this.$emit("search",i()({},this.convertSearchParams()))},resetForm:function(e){this.$refs[e].resetFields(),this.$emit("rest",i()({},this.convertSearchParams()))}}},r=a("SLxE"),c=a.n(r);var d=function(e){a("WM7o")},u=a("C7Lr")(s,c.a,!1,d,"data-v-2d2d21e0",null);t.default=u.exports},nYfD:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("nav-button",[a("el-button-group",[a("nav-premisson-button",{attrs:{comp:e.comp,buttonData:e.buttonData}})],1)],1),e._v(" "),a("common-wrapper",[a("device-management-search",{staticClass:"search",on:{search:e.queryList,rest:e.rest}})],1),e._v(" "),a("common-wrapper",[a("common-table",{attrs:{flex:270}},[a("template",{slot:"table"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.isListLoading,expression:"isListLoading"}],ref:"roleTable",attrs:{height:"100%",stripe:"",data:e.tableData},on:{"selection-change":function(t){return e.selectRow=t}}},[a("el-table-column",{attrs:{type:"selection","min-width":"30"}}),e._v(" "),a("el-table-column",{attrs:{type:"index",index:e.indexMethod,label:"序号","min-width":"50"}}),e._v(" "),a("el-table-column",{attrs:{prop:"devCode",label:"设备编号","min-width":"130"}}),e._v(" "),a("el-table-column",{attrs:{label:"所属线路","min-width":"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.lineName||null))]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"车辆自编号","min-width":"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.busSelfCode||null))]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"车牌号","min-width":"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.busPlateNumber||null))]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"devPhone",label:"设备电话","min-width":"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"devSimNum",label:"SIM卡号","min-width":"110"}}),e._v(" "),a("el-table-column",{attrs:{label:"在线状态","min-width":"70"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s("0"===t.row.devOnlineStatus?"断开":"在线"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"启禁状态","min-width":"70"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{round:""},on:{click:function(a){return e.validDevice(t.$index,t.row)}}},[e._v(e._s("0"===t.row.devIsvalid?"禁用":"启用"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"devUpdateTime",label:"设备状态更新时间",formatter:e.formatCreateDate,"min-width":"150"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作","min-width":"140"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"light",content:"编辑",placement:"bottom"}},[a("el-button",{attrs:{size:"mini",round:"",icon:"fdddfont icon-modify"},on:{click:function(a){return a.stopPropagation(),e.handleEdit(t.$index,t.row)}}})],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"light",content:"删除",placement:"bottom"}},[a("el-button",{attrs:{size:"mini",round:"",icon:"fdddfont icon-delete"},on:{click:function(a){return a.stopPropagation(),e.handleDel(t.$index,t.row)}}})],1)]}}])})],1)],1),e._v(" "),a("template",{slot:"pagination"},[a("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next","current-page":e.pagination.pageNum,"page-size":e.pagination.pageSize,total:e.pagination.total},on:{"update:currentPage":function(t){return e.$set(e.pagination,"pageNum",t)},"update:current-page":function(t){return e.$set(e.pagination,"pageNum",t)},"current-change":e.changePage}})],1)],2)],1),e._v(" "),a("device-update",{attrs:{show:e.isShowRoleDialog,roleData:e.editRole,isCreate:e.isCreate},on:{"update:show":function(t){e.isShowRoleDialog=t},"update:roleData":function(t){e.editRole=t},"update:role-data":function(t){e.editRole=t},updateList:e.queryList}}),e._v(" "),a("upload-file",{attrs:{showUpload:e.showUpload,uploadFileUrl:e.uploadFileUrl,limit:e.limit,size:e.size,acceptType:e.acceptType,pojo:e.pojo,isShowDown:e.isShowDown,isHasToken:e.isHasToken},on:{"update:showUpload":function(t){e.showUpload=t},"update:show-upload":function(t){e.showUpload=t},complete:e.getUploadData}}),e._v(" "),e.uploadData.data?a("upload-file-table",{attrs:{showUploadTable:e.showUploadTable,pojo:e.pojo,uploadData:e.uploadData},on:{"update:showUploadTable":function(t){e.showUploadTable=t},"update:show-upload-table":function(t){e.showUploadTable=t},"update:uploadData":function(t){e.uploadData=t},"update:upload-data":function(t){e.uploadData=t},updateList:e.queryList}}):e._e()],1)},staticRenderFns:[]}}});
//# sourceMappingURL=27.8f2331b2b717e700c5dc.js.map