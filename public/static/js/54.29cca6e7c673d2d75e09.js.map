{"version":3,"sources":["webpack:///./source/admin/src/views/Development/ProductTemplate/Components/UploadExcel.vue?7bbe","webpack:///source/admin/src/views/Development/ProductTemplate/Components/UploadExcel.vue","webpack:///./source/admin/src/views/Development/ProductTemplate/Components/UploadExcel.vue"],"names":["module","exports","render","_vm","this","_h","$createElement","_c","_self","attrs","width","title","visible","isVisible","close-on-click-modal","close-on-press-escape","lock-scroll","on","update:visible","$event","close","cancel","ref","model","checkInfo","rules","formRules","label-width","label","prop","filterable","placeholder","value","callback","$$v","$set","expression","_l","item","index","key","warehouseName","warehouseUuid","_v","staticClass","action","actionUrl","data","auto-upload","on-preview","handlePreview","before-upload","onBeforeUpload","on-change","handleChange","on-remove","handleRemove","before-remove","beforeRemove","multiple","limit","headers","myHeaders","on-success","uploadSuccess","on-error","uploadError","on-exceed","handleExceed","accept","file-list","fileList","size","type","span","loading","isSaving","click","save","staticRenderFns","token","Object","auth","UploadExcel","name","required","message","trigger","Authorization","baseUrlPerFix","props","show","Boolean","default","warehouseList","Array","watch","isShow","session","methods","_this","$refs","validate","isValid","length","uploadFile","submit","$message","showClose","resetFields","clearFiles","$emit","file","files","warning","res","head","code","success","msg","err","__vue_styles__","ssrContext","__webpack_require__","Component","normalizeComponent","UploadExcel_default","a","__webpack_exports__"],"mappings":"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","file":"static/js/54.29cca6e7c673d2d75e09.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-dialog',{attrs:{\"width\":\"500px\",\"title\":\"导入计件表格\",\"visible\":_vm.isVisible,\"close-on-click-modal\":false,\"close-on-press-escape\":false,\"lock-scroll\":true},on:{\"update:visible\":function($event){_vm.isVisible=$event},\"close\":_vm.cancel}},[_c('el-form',{ref:\"checkInfo\",attrs:{\"model\":_vm.checkInfo,\"rules\":_vm.formRules,\"label-width\":\"80px\"}},[_c('el-row',[_c('el-form-item',{attrs:{\"label\":\"仓库\",\"prop\":\"warehouseUuid\"}},[_c('el-select',{attrs:{\"filterable\":\"\",\"placeholder\":\"请选择仓库\"},model:{value:(_vm.checkInfo.warehouseUuid),callback:function ($$v) {_vm.$set(_vm.checkInfo, \"warehouseUuid\", $$v)},expression:\"checkInfo.warehouseUuid\"}},_vm._l((_vm.warehouseList),function(item,index){return _c('el-option',{key:index,attrs:{\"label\":item.warehouseName,\"value\":item.warehouseUuid}})}),1)],1)],1),_vm._v(\" \"),_c('el-row',[_c('el-form-item',{staticClass:\"is-required\",attrs:{\"label\":\"附件\"}},[_c('el-upload',{ref:\"uploadFile\",staticClass:\"upload-demo\",attrs:{\"action\":_vm.actionUrl,\"data\":_vm.checkInfo,\"auto-upload\":false,\"on-preview\":_vm.handlePreview,\"before-upload\":_vm.onBeforeUpload,\"on-change\":_vm.handleChange,\"on-remove\":_vm.handleRemove,\"before-remove\":_vm.beforeRemove,\"multiple\":\"\",\"limit\":1,\"headers\":_vm.myHeaders,\"on-success\":_vm.uploadSuccess,\"on-error\":_vm.uploadError,\"on-exceed\":_vm.handleExceed,\"accept\":\"application/vnd.ms-excel, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\",\"file-list\":_vm.fileList}},[_c('el-button',{attrs:{\"size\":\"mini\",\"type\":\"primary\"}},[_vm._v(\"选择附件\")])],1)],1)],1),_vm._v(\" \"),_c('el-row',[_c('el-col',{staticClass:\"flex-right\",attrs:{\"span\":24}},[_c('el-button',{attrs:{\"type\":\"primary\",\"loading\":_vm.isSaving},on:{\"click\":function($event){return _vm.save()}}},[_vm._v(\"提交\")]),_vm._v(\" \"),_c('el-button',{on:{\"click\":function($event){return _vm.cancel()}}},[_vm._v(\"取消\")])],1)],1)],1)],1)}\nvar staticRenderFns = []\nmodule.exports = { render: render, staticRenderFns: staticRenderFns }\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler?{\"id\":\"data-v-b0891f5c\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@13.7.3@vue-loader/lib/selector.js?type=template&index=0!./source/admin/src/views/Development/ProductTemplate/Components/UploadExcel.vue\n// module id = FSgm\n// module chunks = 9 54","<template>\r\n  <el-dialog\r\n    width=\"500px\"\r\n    title=\"导入计件表格\"\r\n    :visible.sync=\"isVisible\"\r\n    :close-on-click-modal=\"false\"\r\n    :close-on-press-escape=\"false\"\r\n    :lock-scroll=\"true\"\r\n    @close=\"cancel\">\r\n    <el-form ref=\"checkInfo\" :model=\"checkInfo\" :rules=\"formRules\" label-width=\"80px\">\r\n      <el-row>\r\n        <el-form-item label=\"仓库\" prop=\"warehouseUuid\">\r\n          <el-select v-model=\"checkInfo.warehouseUuid\" filterable placeholder=\"请选择仓库\">\r\n            <el-option\r\n                v-for=\"(item, index) in warehouseList\"\r\n                :key=\"index\"\r\n                :label=\"item.warehouseName\"\r\n                :value=\"item.warehouseUuid\">\r\n            </el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n      </el-row>\r\n      <el-row>\r\n        <el-form-item class=\"is-required\" label=\"附件\">\r\n          <el-upload\r\n            ref=\"uploadFile\"\r\n            class=\"upload-demo\"\r\n            :action=\"actionUrl\"\r\n            :data=\"checkInfo\"\r\n            :auto-upload=\"false\"\r\n            :on-preview=\"handlePreview\"\r\n            :before-upload=\"onBeforeUpload\"\r\n            :on-change=\"handleChange\"\r\n            :on-remove=\"handleRemove\"\r\n            :before-remove=\"beforeRemove\"\r\n            multiple\r\n            :limit=\"1\"\r\n            :headers=\"myHeaders\"\r\n            :on-success=\"uploadSuccess\"\r\n            :on-error=\"uploadError\"\r\n            :on-exceed=\"handleExceed\"\r\n            accept=\"application/vnd.ms-excel, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"\r\n            :file-list=\"fileList\">\r\n            <el-button  size=\"mini\" type=\"primary\">选择附件</el-button>\r\n          </el-upload>\r\n        </el-form-item>\r\n      </el-row>\r\n      <el-row>\r\n        <el-col :span=\"24\" class=\"flex-right\">\r\n          <el-button type=\"primary\" @click=\"save()\" :loading=\"isSaving\">提交</el-button>\r\n          <el-button @click=\"cancel()\">取消</el-button>\r\n        </el-col>\r\n      </el-row>\r\n    </el-form>\r\n  </el-dialog>\r\n</template>\r\n\r\n<script>\r\n  import {importPiece} from '@/api/warehouse'\r\n  // api\r\n  import { BASE_PER_FIX_URL } from '@/utils/baseUrlPerFix.js'\r\n  import { setSession, getSession } from '@/utils/session'\r\n  import { getToken } from '@/utils/auth.js'\r\n\r\n  const token = getToken()\r\n  export default {\r\n    name: 'UploadExcel',\r\n    data() {\r\n      return {\r\n        isVisible: false,\r\n        checkInfo: {\r\n          warehouseUuid:''\r\n        },\r\n          formRules: {\r\n              warehouseUuid: [{required: true, message: '请选择仓库', trigger: 'blur'}],\r\n          },\r\n        //上传文件\r\n        myHeaders: {Authorization: token}, // 添加认证码\r\n        fileList:[],\r\n        actionUrl: BASE_PER_FIX_URL+'/product/cost/import',\r\n        isSaving:false\r\n      }\r\n    },\r\n    props: {\r\n      show: {\r\n        type: Boolean,\r\n        required: true,\r\n        default: false\r\n      },\r\n        warehouseList: {\r\n            type: Array\r\n        }\r\n    },\r\n    watch: {\r\n      show(isShow) {\r\n        this.isVisible = isShow\r\n        this.checkInfo.warehouseUuid = getSession('warehouseUuid')\r\n      }\r\n    },\r\n    methods: {\r\n      save() {\r\n        this.$refs.checkInfo.validate(isValid => {\r\n          if (isValid) {\r\n             if(this.fileList.length > 0){\r\n                this.$refs.uploadFile.submit();\r\n              }else{\r\n                this.$message({\r\n                  showClose: true,\r\n                  message: '请上传附件',\r\n                  type: 'warning'\r\n                })\r\n              }\r\n          }\r\n        })\r\n      },\r\n      cancel() {\r\n        this.isVisible = false\r\n        this.$refs.checkInfo.resetFields()\r\n        this.fileList = []\r\n        this.$refs.uploadFile.clearFiles()\r\n        this.$emit('update:show', false)\r\n      },\r\n      //上传文件\r\n      handleRemove(file, fileList) {\r\n        this.fileList = fileList\r\n      },\r\n      handlePreview(file) {\r\n\r\n      },\r\n      handleExceed(files, fileList) {\r\n        this.$message.warning(`当前限制选择 1 个文件，本次选择了 ${files.length} 个文件，共选择了 ${files.length + fileList.length} 个文件`);\r\n      },\r\n      beforeRemove(file, fileList) {\r\n        // return this.$confirm(`确定移除 ${ file.name }？`);\r\n      },\r\n      handleChange(file,fileList){\r\n        this.fileList = fileList\r\n      },\r\n      uploadSuccess (res,file,fileList) {\r\n        if(res.head.code == 200 && res.head.success == 'true'){\r\n          this.$message({\r\n            type: 'success',\r\n            message: '表格已导入！'\r\n          })\r\n          this.cancel()\r\n          this.$emit('updateList')\r\n        } else if(res.head.code == 201 && res.head.success == 'false'){\r\n          this.$message({\r\n            type: 'warning',\r\n            message: res.head.msg\r\n          })\r\n          this.cancel()\r\n          this.$emit('updateList')\r\n        }\r\n      },\r\n      uploadError (err) {\r\n        this.$message({\r\n          type: 'error',\r\n          message: '导入表格失败！'\r\n        })\r\n      },\r\n      onBeforeUpload (file) {\r\n        // let isExcel = (file.type === 'application/vnd.ms-excel') || (file.type ==='application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')\r\n        // if (!isExcel) {\r\n        //   this.$message({\r\n        //     type: 'error',\r\n        //     message:'上传文件只能是表格格式!'\r\n        //   });\r\n        // }\r\n        // return isExcel\r\n      },\r\n    }\r\n  }\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n  .recordList {\r\n    border-bottom: 1px solid #e7e7e7;\r\n  }\r\n  .result{\r\n    font-size: 12px;\r\n    margin-right: 10px;\r\n    border: 1px solid;\r\n    line-height: 15px;\r\n    border-radius: 5px;\r\n    height: 15px;\r\n    margin-top: 4px;\r\n    padding: 0 4px;\r\n    color: #fff;\r\n  }\r\n  .fail {\r\n    border-color: #F56C6C;\r\n    background-color: #F56C6C;\r\n  }\r\n\r\n  .success {\r\n    border-color: #67C23A;\r\n    background-color: #67C23A;\r\n  }\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// source/admin/src/views/Development/ProductTemplate/Components/UploadExcel.vue","function injectStyle (ssrContext) {\n  require(\"!!../../../../../../../node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-b0891f5c\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader!sass-resources-loader?{\\\"resources\\\":[\\\"D:\\\\\\\\workspace\\\\\\\\wms_web\\\\\\\\source\\\\\\\\admin\\\\\\\\src\\\\\\\\common\\\\\\\\style\\\\\\\\common.scss\\\"]}!../../../../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=styles&index=0!./UploadExcel.vue\")\n}\nvar normalizeComponent = require(\"!../../../../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./UploadExcel.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./UploadExcel.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-b0891f5c\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=template&index=0!./UploadExcel.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-b0891f5c\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./source/admin/src/views/Development/ProductTemplate/Components/UploadExcel.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}