webpackJsonp([4,28,43,44,47],{"4pZS":function(e,t,r){var a=r("58gO");a(a.S,"Object",{is:r("xrZo")})},B64f:function(e,t){},CqIm:function(e,t){},Gn17:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-dialog",{staticClass:"heightDialog",attrs:{title:(1==e.openType?"新增":"编辑")+"收货单",visible:e.isVisible,"close-on-click-modal":!1,"close-on-press-escape":!1,"lock-scroll":!0,width:"95%",top:"5vh","before-close":e.cancel},on:{"update:visible":function(t){e.isVisible=t},close:e.cancel}},[r("el-form",{ref:"orderInfo",attrs:{model:e.orderInfo,rules:e.orderFormRules,"label-width":"60px"}},[r("el-row",[r("el-col",{attrs:{span:5}},[r("el-form-item",{attrs:{label:"商户",prop:"goodsReceiveMerchantId"}},[r("el-select",{attrs:{placeholder:"请选择商户",filterable:""},on:{change:e.changeMerchants},model:{value:e.orderInfo.goodsReceiveMerchantId,callback:function(t){e.$set(e.orderInfo,"goodsReceiveMerchantId",t)},expression:"orderInfo.goodsReceiveMerchantId"}},e._l(e.merchantsList,function(e,t){return r("el-option",{key:t,attrs:{disabled:e.disabled,label:e.userName,value:e.userUuid}})}),1)],1)],1),e._v(" "),r("el-col",{attrs:{span:5}},[r("el-form-item",{attrs:{label:"类型",prop:"goodsReceiveType"}},[r("el-select",{staticClass:"w100p",attrs:{placeholder:"请选择收货单类型"},model:{value:e.orderInfo.goodsReceiveType,callback:function(t){e.$set(e.orderInfo,"goodsReceiveType",t)},expression:"orderInfo.goodsReceiveType"}},[r("el-option",{staticClass:"radio",attrs:{value:"1",label:"采购入库"}}),e._v(" "),r("el-option",{staticClass:"radio",attrs:{value:"2",label:"搬仓入库"}}),e._v(" "),r("el-option",{staticClass:"radio",attrs:{value:"3",label:"提货入库"}}),e._v(" "),r("el-option",{staticClass:"radio",attrs:{value:"4",label:"售后入库"}}),e._v(" "),r("el-option",{staticClass:"radio",attrs:{value:"5",label:"展厅下样入库"}}),e._v(" "),r("el-option",{staticClass:"radio",attrs:{value:"6",label:"展厅撤场入库"}})],1)],1)],1),e._v(" "),r("el-col",{attrs:{span:7}},[r("el-form-item",{attrs:{label:"送达日期",prop:"goodsReceiveDate","label-width":"90px"}},[r("el-date-picker",{staticClass:"w100p",attrs:{align:"right",type:"date",placeholder:"选择日期",format:"yyyy 年 MM 月 dd 日","value-format":"yyyy-MM-dd"},model:{value:e.orderInfo.goodsReceiveDate,callback:function(t){e.$set(e.orderInfo,"goodsReceiveDate",t)},expression:"orderInfo.goodsReceiveDate"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:7}},[r("el-form-item",{attrs:{label:"备注",prop:"goodsReceiveRemark"}},[r("el-input",{staticClass:"create_textarea",attrs:{type:"textarea",autosize:{maxRows:3},maxlength:"200",resize:"none",placeholder:"请输入收货单备注，最长200字符"},model:{value:e.orderInfo.goodsReceiveRemark,callback:function(t){e.$set(e.orderInfo,"goodsReceiveRemark",t)},expression:"orderInfo.goodsReceiveRemark"}})],1)],1)],1),e._v(" "),r("el-row",[r("div",[r("common-table",{attrs:{flex:300}},[r("template",{slot:"table"},[r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.isListLoading,expression:"isListLoading"}],ref:"orderTable",attrs:{height:"100%",stripe:"",border:!0,data:e.tableData}},[r("el-table-column",{attrs:{type:"index",label:"序号",width:"50",fixed:"left","header-align":"center"}}),e._v(" "),r("el-table-column",{attrs:{label:"品牌",prop:"productBrand"}}),e._v(" "),r("el-table-column",{attrs:{label:"型号",prop:"productModel"}}),e._v(" "),r("el-table-column",{attrs:{label:"货品名称",prop:"productName"}}),e._v(" "),r("el-table-column",{attrs:{label:"规格",prop:"productStandard"}}),e._v(" "),r("el-table-column",{attrs:{label:"颜色",prop:"productColor"}}),e._v(" "),r("el-table-column",{attrs:{label:"货品类型","header-align":"center","min-width":"110"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-select",{attrs:{disabled:t.row.typeDisabled,placeholder:"请选择"},model:{value:t.row.productType,callback:function(r){e.$set(t.row,"productType",r)},expression:"scope.row.productType"}},[r("el-option",{attrs:{value:"0",label:"小件"}}),e._v(" "),r("el-option",{attrs:{value:"1",disabled:!0,label:"套件"}}),e._v(" "),r("el-option",{attrs:{value:"2",label:"单品"}})],1)]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"包装形式","header-align":"center","min-width":"110",formatter:e.PackFormatter},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-select",{attrs:{disabled:"1"!=e.openType,placeholder:"请选择"},model:{value:t.row.receiveItemPack,callback:function(r){e.$set(t.row,"receiveItemPack",r)},expression:"scope.row.receiveItemPack"}},e._l(e.packagedType,function(e,t){return r("el-option",{key:t,attrs:{label:e.label,value:e.value}})}),1)]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"子件","min-width":"120","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.productItemUuid&&"1"==t.row.productType?r("el-tooltip",{attrs:{placement:"top",effect:"light",enterable:"","visible-arrow":!1}},[r("div",{attrs:{slot:"content"},slot:"content"},[r("div",[e._v("\n                  "+e._s(e.getItemName(t.row.productItemUuid))+"\n                ")])]),e._v(" "),"1"==t.row.productType?r("el-select",{on:{change:function(r){return e.changeModel(t.row,t.$index)}},model:{value:t.row.productItemUuid,callback:function(r){e.$set(t.row,"productItemUuid",r)},expression:"scope.row.productItemUuid"}},e._l(t.row.productItems,function(e,t){return r("el-option",{key:t,attrs:{disabled:!1,label:e.productItemName,value:e.productItemUuid}})}),1):e._e()],1):e._e(),e._v(" "),t.row.productItemUuid||"1"!=t.row.productType?e._e():r("el-select",{on:{change:function(r){return e.changeModel(t.row,t.$index)}},model:{value:t.row.productItemUuid,callback:function(r){e.$set(t.row,"productItemUuid",r)},expression:"scope.row.productItemUuid"}},e._l(t.row.productItems,function(e,t){return r("el-option",{key:t,attrs:{disabled:e.disabled,label:e.productItemName,value:e.productItemUuid}})}),1)]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"数量","header-align":"center","min-width":"110"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-input-number",{staticClass:"productCount",attrs:{"controls-position":"right",min:1,max:99999,size:"mini"},model:{value:t.row.receiveItemCount,callback:function(r){e.$set(t.row,"receiveItemCount",r)},expression:"scope.row.receiveItemCount"}})]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"备注","min-width":"140","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-input",{staticClass:"create_textarea",attrs:{type:"textarea",autosize:{maxRows:2},maxlength:"200",resize:"none",placeholder:"最长200字符"},model:{value:t.row.receiveItemRemark,callback:function(r){e.$set(t.row,"receiveItemRemark",r)},expression:"scope.row.receiveItemRemark"}})]}}])}),e._v(" "),r("el-table-column",{attrs:{"render-header":e.renderHeader,fixed:"right",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"text",rules:"small"},nativeOn:{click:function(r){return r.preventDefault(),e.deleteRow(t.$index,t.row)}}},[e._v("\n                删除\n              ")])]}}])})],1)],1)],2)],1)]),e._v(" "),r("el-row",[r("el-col",{staticClass:"text-r mar-t-10",attrs:{span:5,offset:19}},[r("el-button",{attrs:{type:"primary",loading:e.isSaveing},on:{click:function(t){return e.save()}}},[e._v("提交")]),e._v(" "),r("el-button",{on:{click:function(t){return e.cancel()}}},[e._v("取消")])],1)],1)],1)],1),e._v(" "),r("template-create",{staticClass:"highIndex",attrs:{show:e.isCreateTemplateshow,searchParams:e.searchParams,merchantsList:e.merchantsList,merchants:e.orderInfo.goodsReceiveMerchantId,brandList:e.brandList,warehouseList:e.warehouseList},on:{"update:show":function(t){e.isCreateTemplateshow=t},sendDataOut:e.receiveData,reset:e.resetRow}}),e._v(" "),r("template-import",{attrs:{show:e.importVisible,merchantsList:e.merchantsList},on:{"update:show":function(t){e.importVisible=t},updateList:e.queryList}}),e._v(" "),r("template-select",{attrs:{show:e.isTemplateShow,merchantsList:e.merchantsList,merchantId:e.orderInfo.goodsReceiveMerchantId},on:{"update:show":function(t){e.isTemplateShow=t},sendData:e.receiveData}})],1)},staticRenderFns:[]}},Js8z:function(e,t){},NJMI:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-form",{ref:"searchForm",attrs:{model:e.searchForm,"label-width":"50px"}},[r("el-row",[r("el-col",{attrs:{span:4}},[r("el-form-item",{attrs:{label:"仓库",prop:"warehouseUuid"}},[r("el-select",{staticClass:"w100p",attrs:{filterable:""},on:{change:e.getMerchantsList},model:{value:e.searchForm.warehouseUuid,callback:function(t){e.$set(e.searchForm,"warehouseUuid",t)},expression:"searchForm.warehouseUuid"}},e._l(e.warehouseList,function(e,t){return r("el-option",{key:t,attrs:{label:e.warehouseName,value:e.warehouseUuid}})}),1)],1)],1),e._v(" "),r("el-col",{attrs:{span:4}},[r("el-form-item",{attrs:{label:"商户",prop:"merchantUuid"}},[r("el-select",{staticClass:"w100p",attrs:{filterable:"",clearable:"",filterable:"",placeholder:"请选择商户"},on:{change:e.getBrandList},model:{value:e.searchForm.merchantUuid,callback:function(t){e.$set(e.searchForm,"merchantUuid",t)},expression:"searchForm.merchantUuid"}},e._l(e.merchantsList,function(e,t){return r("el-option",{key:t,attrs:{label:e.userName,value:e.userUuid}})}),1)],1)],1),e._v(" "),r("el-col",{attrs:{span:5}},[r("el-form-item",{attrs:{label:"收货单号","label-width":"80px",prop:"receiveOrderId"}},[r("el-input",{attrs:{maxlength:"200",placeholder:"请输入收货单号"},model:{value:e.searchForm.receiveOrderId,callback:function(t){e.$set(e.searchForm,"receiveOrderId",t)},expression:"searchForm.receiveOrderId"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:4}},[r("el-form-item",{attrs:{label:"状态",prop:"orderStatus"}},[r("el-select",{staticClass:"w100p",attrs:{filterable:"",clearable:""},model:{value:e.searchForm.orderStatus,callback:function(t){e.$set(e.searchForm,"orderStatus",t)},expression:"searchForm.orderStatus"}},[r("el-option",{staticClass:"radio",attrs:{value:"0",label:"待提交"}}),e._v(" "),r("el-option",{staticClass:"radio",attrs:{value:"1",label:"待审核"}}),e._v(" "),r("el-option",{staticClass:"radio",attrs:{value:"2",label:"审核通过"}}),e._v(" "),r("el-option",{staticClass:"radio",attrs:{value:"3",label:"审核未通过"}})],1)],1)],1)],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:6}},[r("el-form-item",{attrs:{label:"送达日期(起)","label-width":"100px",prop:"startDate"}},[r("el-date-picker",{staticClass:"w100p",attrs:{type:"date",align:"right",clearable:"","unlink-panels":"",placeholder:"请选择送达日期(起)",format:"yyyy 年 MM 月 dd 日","value-format":"yyyy-MM-dd",size:"mini"},model:{value:e.searchForm.startDate,callback:function(t){e.$set(e.searchForm,"startDate",t)},expression:"searchForm.startDate"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:6}},[r("el-form-item",{attrs:{label:"送达日期(止)","label-width":"100px",prop:"endDate"}},[r("el-date-picker",{staticClass:"w100p",attrs:{type:"date",align:"right",clearable:"","unlink-panels":"",placeholder:"请选择送达日期(止)",format:"yyyy 年 MM 月 dd 日","value-format":"yyyy-MM-dd",size:"mini"},model:{value:e.searchForm.endDate,callback:function(t){e.$set(e.searchForm,"endDate",t)},expression:"searchForm.endDate"}})],1)],1),e._v(" "),r("el-col",{staticClass:"flex-right",attrs:{span:4,offset:2}},[r("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.search(t)}}},[e._v("查询")]),e._v(" "),r("el-button",{on:{click:function(t){return e.resetForm("searchForm")}}},[e._v("重置")])],1)],1)],1)},staticRenderFns:[]}},QP2q:function(e,t){},T2UM:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("rVsN"),o=r.n(a),i=r("aA9S"),s=r.n(i),n=r("ryJa"),l=r.n(n),c=r("aIe1"),d=r("VkjD"),u=r("ycWN"),h=r("I8tE"),p=r("Ips9"),m=(r("4+6g"),r("fBur"),r("rHLQ")),f={name:"OrderDetail",data:function(){return{isVisible:!1,orderInfo:{},existModel:[],tableData:[],qrCodeVisible:!1,paramsList:[],isListLoading:!1}},props:{show:{type:Boolean,default:!1},selectedOrderInfo:{type:Object}},watch:{show:function(e){e&&(this.isVisible=e,this.orderInfo=s()({},this.selectedOrderInfo),this.tableData=[].concat(this.orderInfo.goodsReceiveItems))}},methods:{getTemplate:function(){var e=this;return new o.a(function(t){var r={merchantUuid:e.orderInfo.goodsReceiveMerchantId};e.existModel=[],e.isListLoading=!0,Object(h.g)(r).then(function(r){e.isListLoading=!1,r.forEach(function(e){delete e.productItemUuid}),e.existModel=[].concat(r),t()})})},getMerchantName:function(e){return this.merchantsList.find(function(t){return t.userUuid===e}).userName},cancel:function(){this.orderInfo={},this.tableData=[],this.existModel=[],this.$refs.orderInfo.resetFields(),this.$emit("update:show",!1),this.isVisible=!1},PackFormatter:function(e){return"1"===e.receiveItemPack?"有包装":"2"===e.receiveItemPack?"无包装":"其他"},typeFormatter:function(e){return"0"===e.productType?"小件":"1"===e.productType?"套件":"2"===e.productType?"单品":"未知"},itemFormatter:function(e){if("1"==e.productType&&e.productItems.length){var t=e.productItems.find(function(t){return e.productItemUuid===t.productItemUuid});return t?t.productItemName:""}},formatTime:function(e){if(e)return l()(e).utcOffset(8).format("YYYY-MM-DD")},printCode:function(){var e=this,t={orderAccount:[this.orderInfo.goodsReceiveUuid]};Object(p.d)(t).then(function(t){e.paramsList=[],e.paramsList=t,e.qrCodeVisible=!0})},addCode:function(e,t){var r=this;this.$confirm("提醒 条码补打会导致货品数量增加，确定要补打吗？","提示",{type:"warning"}).then(function(){r.$prompt("请输入补打数量","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^[1-9]{1}\d{0,4}$/,inputErrorMessage:"条码数量应在0-99999之间"}).then(function(a){var o=a.value,i={goodReceiveItemUuid:e.receiveItemUuid,count:o};Object(p.a)(i).then(function(a){a.error||(r.paramsList=[],r.paramsList=a,r.qrCodeVisible=!0,e.receiveItemCount=Number(e.receiveItemCount)+Number(o),r.$emit("updateCount",o,t))})}).catch(function(){})}).catch(function(){})}},components:{QrCode:m.default,CommonTable:c.a,TemplateCreate:d.default,TemplateImport:u.default}},v=r("to5v"),b=r.n(v);var g=function(e){r("ywEJ")},w=r("C7Lr")(f,b.a,!1,g,null,null);t.default=w.exports},TGOP:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("aA9S"),o=r.n(a),i=r("fBur"),s=r("ryJa"),n=r.n(s),l={name:"EntryManagementSearch",data:function(){return{searchForm:{warehouseUuid:"",receiveOrderId:"",merchantUuid:"",productBrand:"",goodsReceiveDate:"",orderStatus:"",startDate:"",endDate:""}}},props:{warehouseList:{type:Array},merchantsList:{type:Array},brandList:{type:Array}},mounted:function(){this.searchForm.warehouseUuid=Object(i.b)("warehouseUuid"),this.$emit("search",o()({},this.searchForm)),this.getMerchantsList(Object(i.b)("warehouseUuid"))},methods:{getMerchantsList:function(e){this.searchForm.merchantUuid="",this.searchForm.productBrand="",this.searchForm.goodsReceiveMerchantId="",Object(i.e)("warehouseUuid",e),this.$emit("getMerchants",{warehouseUuid:e}),this.$emit("getBrandModel",{warehouseUuid:e}),this.$emit("search",o()({},this.searchForm))},getBrandList:function(){this.searchForm.productBrand="",this.$emit("getBrandModel",{warehouseUuid:this.searchForm.warehouseUuid,merchantUuid:this.searchForm.merchantUuid})},search:function(){this.searchForm.endDate&&this.searchForm.startDate&&(n()(this.searchForm.endDate).isBefore(this.searchForm.startDate)||n()(this.searchForm.endDate).isSame(this.searchForm.startDate))?(this.$message({message:"送达日期(止)不能早于送达日期(起)，请重新选择！",type:"warning"}),this.searchForm.endDate=null):this.$emit("search",o()({},this.searchForm))},resetForm:function(e){this.$refs[e].resetFields(),this.searchForm.warehouseUuid=Object(i.b)("warehouseUuid"),this.$emit("rest",o()({},this.searchForm))}}},c=r("NJMI"),d=r.n(c);var u=function(e){r("CqIm")},h=r("C7Lr")(l,d.a,!1,u,"data-v-dd46b3a8",null);t.default=h.exports},VQjE:function(e,t,r){r("4pZS"),e.exports=r("aftD").Object.is},W4Qu:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{attrs:{width:"400px",title:"审核意见",visible:e.isVisible,"close-on-click-modal":!1,"close-on-press-escape":!1,"lock-scroll":!0},on:{"update:visible":function(t){e.isVisible=t},close:e.cancel}},[r("el-form",{ref:"ensureInfo",attrs:{model:e.ensureInfo,rules:e.formRules,"label-width":"80px"}},[r("el-row",[r("el-form-item",{attrs:{label:"审核结果",prop:"checkResult"}},[r("el-radio-group",{model:{value:e.ensureInfo.checkResult,callback:function(t){e.$set(e.ensureInfo,"checkResult",t)},expression:"ensureInfo.checkResult"}},[r("el-radio",{attrs:{label:2}},[e._v("通过")]),e._v(" "),r("el-radio",{attrs:{label:3}},[e._v("不通过")])],1)],1)],1),e._v(" "),r("el-row",[r("el-form-item",{attrs:{label:"审核意见",prop:"checkSuggest"}},[r("el-input",{attrs:{type:"textarea",maxlength:"200",placeholder:"请输入您的审核意见,最长200字符"},model:{value:e.ensureInfo.checkSuggest,callback:function(t){e.$set(e.ensureInfo,"checkSuggest",t)},expression:"ensureInfo.checkSuggest"}})],1)],1),e._v(" "),r("el-row",[r("el-col",{staticClass:"flex-right",attrs:{span:24}},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.save()}}},[e._v("提交")]),e._v(" "),r("el-button",{on:{click:function(t){return e.cancel()}}},[e._v("取消")])],1)],1)],1)],1)},staticRenderFns:[]}},X1IT:function(e,t,r){e.exports={default:r("VQjE"),__esModule:!0}},afXj:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("Ips9"),o={name:"EnsureCheck",data:function(){return{isVisible:!1,ensureInfo:{},formRules:{checkResult:[{required:!0,message:"请选择审核结果",trigger:"blur"}]}}},props:{show:{type:Boolean,required:!0,default:!1},checkInfo:{type:Object}},methods:{save:function(){var e=this;this.$refs.ensureInfo.validate(function(t){if(t){console.log(e.checkInfo);var r={orderAccount:[e.checkInfo.goodsReceiveUuid],checkSuggest:e.checkSuggest,checkStatus:e.ensureInfo.checkResult};Object(a.h)(r).then(function(t){t.error||(e.$message({message:"审核完成",type:"success"}),e.cancel(),e.$emit("updateTable"))})}})},cancel:function(){this.isVisible=!1,this.$refs.ensureInfo.resetFields(),this.$emit("update:show",!1)}},watch:{show:function(e){this.isVisible=e}}},i=r("W4Qu"),s=r.n(i);var n=function(e){r("QP2q")},l=r("C7Lr")(o,s.a,!1,n,"data-v-cfc4b6e6",null);t.default=l.exports},g9Ix:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("4YfN"),o=r.n(a),i=r("X1IT"),s=r.n(i),n=r("YTJj"),l=r.n(n),c=r("HzJ8"),d=r.n(c),u=r("rVsN"),h=r.n(u),p=r("aA9S"),m=r.n(p),f=r("aIe1"),v=r("VkjD"),b=r("ycWN"),g=r("Q8cT"),w=r("I8tE"),I=r("Ips9"),y=r("4+6g"),_=r("fBur"),L=r("rHLQ"),k={receiveItemPack:"1",receiveItemCount:"1"},x={name:"OrderCreate",data:function(){return{originalData:{},isSaveing:!1,createIndex:"",isCreateTemplateshow:!1,isVisible:!1,orderInfo:{},isListLoading:!1,packagedType:[{value:"1",label:"有包装"},{value:"2",label:"无包装"},{value:"3",label:"其他"}],originModel:[],existModel:[],modelBrand:[],brandList:[],modelList:[],tableData:[],orderFormRules:{goodsReceiveMerchantId:[{required:!0,message:"请选择商户",trigger:"blur"}],goodsReceiveType:[{required:!0,message:"请选择订单类型",trigger:"blur"}],goodsReceiveDate:[{required:!0,message:"请选择送达时间",trigger:"blur"}]},importVisible:!1,hasSaved:!1,selectIndex:"",isTemplateShow:!1}},props:{show:{type:Boolean,default:!1},openType:{type:Number,default:1},selectedOrderInfo:{type:Object},warehouseList:{type:Array},merchantsList:{type:Array},searchParams:{type:Object}},watch:{show:function(e){var t=this;e&&(2===this.openType||3===this.openType?(this.originalData=m()({},this.selectedOrderInfo),this.orderInfo=m()({},this.selectedOrderInfo),this.orderInfo.goodsReceiveItems.forEach(function(e){e.productUuid=e.receiveItemProductId}),this.tableData=[].concat(this.orderInfo.goodsReceiveItems),this.tableData.forEach(function(e){""!=e.productType&&(e.typeDisabled=!0),t.changeModel(e)})):this.tableData=[]),this.isVisible=e}},methods:{changeMerchants:function(e){this.tableData=[],this.existModel=[],this.originModel=[],this.getBrandModel({warehouseUuid:Object(_.b)("warehouseUuid"),merchantUuid:e})},getBrandModel:function(e){var t=this;Object(y.h)(e).then(function(e){e.error||(t.brandList=[],t.modelList=[],e.forEach(function(e,r){t.brandList.push(e.productBrand),e.productModel.forEach(function(e){t.modelList.push(e)})}),t.modelBrand=e)})},getTemplate:function(){var e=this;return new h.a(function(t){var r={merchantUuid:e.orderInfo.goodsReceiveMerchantId};e.isListLoading=!0,Object(w.g)(r).then(function(r){e.isListLoading=!1,e.originModel=[],e.originModel=e.originModel.concat(r);var a=function(e){delete e.descOrAsc,delete e.orderBy,delete e.pageNum,delete e.pageSize,delete e.productItemUuid,e.disabled=!1,""==e.productType?e.typeDisabled=!1:e.typeDisabled=!0,"1"==e.productType&&e.productItems.length&&e.productItems.forEach(function(t){t.disabled=!1,e.productItemUuid=e.productItems[0].productItemUuid})},o=!0,i=!1,s=void 0;try{for(var n,l=d()(e.originModel);!(o=(n=l.next()).done);o=!0){a(n.value)}}catch(e){i=!0,s=e}finally{try{!o&&l.return&&l.return()}finally{if(i)throw s}}e.originModel.unshift({productUuid:"新增",productModel:"新增"}),t()})})},renderHeader:function(e,t){var r=this;return l()(t),e("el-button",{class:["addBtn","el-button--primary"],domProps:{innerHTML:"添加货品"},on:{click:function(){r.addRow()}}})},addRow:function(){this.orderInfo.goodsReceiveMerchantId?(this.isTemplateShow=!0,this.selectIndex=this.tableData.length):this.$message({type:"warning",message:"请选择商户"})},deleteRow:function(e,t){"1"==t.productType&&t.productItems&&t.productItems.length&&this.tableData.forEach(function(e){e.productUuid==t.productUuid&&e.productItems.forEach(function(e){e.productItemUuid==t.productItemUuid&&(e.disabled=!1)})}),this.tableData.splice(e,1)},receiveData:function(e){var t=this;e.forEach(function(e){if(""!==e.productType&&(e.typeDisabled=!0),"1"==(e=m()(e,k)).productType&&e.productItems&&e.productItems.length)e.productItems.forEach(function(r){e.productItemUuid=r.productItemUuid,r.disabled=!0;var a=m()({},e);t.tableData.unshift(a),t.changeModel(a),t.selectIndex++});else if("1"!=e.productType){var r=m()({},e);t.tableData.unshift(r),t.selectIndex++}})},resetRow:function(e){e||(k.productUuid="",this.$set(this.existModel,this.createIndex,this.originModel),this.$set(this.tableData,this.createIndex,k))},cancel:function(){var e=this;!this.hasSaved&&s()(this.originalData,this.orderInfo)?this.$confirm("确认要取消编辑吗？","提醒",{confirmButtonText:"确定",cancelButtonText:"继续编辑"}).then(function(){e.existModel=[],e.originModel=[],e.tableData=[],e.orderInfo={},e.originalData={},e.$refs.orderInfo.resetFields(),e.$emit("update:show",!1),e.isVisible=!1}).catch(function(){}):(this.existModel=[],this.originModel=[],this.tableData=[],this.orderInfo={},this.originalData={},this.$refs.orderInfo.resetFields(),this.$emit("update:show",!1),this.isVisible=!1)},dealModel:function(e,t){""!==e?(this.existModel=this.originModel.filter(function(t){return t.productBrand===e}),this.existModel.unshift({productUuid:"新建",productModel:"新建"})):""===e&&(this.existModel=[].concat(this.originModel))},changeModel:function(e){if("1"==e.productType&&e.productItems&&e.productItems.length){var t=[],r=this.tableData.filter(function(t){return t.productUuid==e.productUuid});r&&r.length&&r.forEach(function(e){t.push(e.productItemUuid)}),this.tableData.forEach(function(r){r.productUuid==e.productUuid&&r.productItems.forEach(function(e){var r=t.find(function(t){return t==e.productItemUuid});e.disabled=!!r})})}},changeItem:function(e,t){var r=this.tableData.filter(function(t){return t.productUuid===e.productUuid});r&&r.length&&this.existModel.forEach(function(e){e.forEach(function(e){"1"===e.productType&&e.productItems.forEach(function(e){var t=r.find(function(t){return t.productItemUuid===e.productItemUuid});e.disabled=!!t})})})},getItemName:function(e){var t=this.tableData.find(function(t){return t.productItemUuid==e});if(t){var r=t.productItems.find(function(t){return t.productItemUuid==e});if(r)return r.productItemName}},save:function(){var e=this;this.$refs.orderInfo.validate(function(t){if(t){if(!e.tableData.length)return void e.$message({message:"请补全货物信息",type:"warning"});var r=!0,a=!1,i=void 0;try{for(var s,n=d()(e.tableData);!(r=(s=n.next()).done);r=!0){var l=s.value;if(l.receiveItemProductId=l.productUuid,delete l.productItems,!l||!l.productUuid||""===l.productUuid)return void e.$message({message:"请补全货物信息",type:"warning"});if(""==l.productType)return void e.$message({message:"请选择货品类型",type:"warning"})}}catch(e){a=!0,i=e}finally{try{!r&&n.return&&n.return()}finally{if(a)throw i}}var c=o()({},e.orderInfo,{goodsWarehouseUuid:Object(_.b)("warehouseUuid"),goodsReceiveMerchant:e.merchantsList.find(function(t){return t.userUuid===e.orderInfo.goodsReceiveMerchantId}).userName,goodsReceiveItems:e.tableData});e.isSaveing=!0,Object(I.o)(c).then(function(t){if(e.isSaveing=!1,!t.error){var r=1==e.openType?"新增":"编辑";e.$message({message:r+"成功!",type:"success"}),e.hasSaved=!0,e.cancel(),e.queryList()}})}})},PackFormatter:function(e){return"1"===e.receiveItemPack?"有包装":"0"===e.receiveItemPack?"无包装":"未知"},uploadProd:function(){this.importVisible=!0},queryList:function(){this.$emit("search",this.searchParams)},printCode:function(){var e=this;this.paramsList=[],this.tableData.forEach(function(t){e.paramsList.push(t.productUuid)}),this.qrCodeVisible=!0},dealItemName:function(e){var t="";return"1"==e.productType&&e.productItems.length?(t="子件:",e.productItems.forEach(function(r,a){t+=r.productItemName+(a===e.productItems.length-1?"":"、")})):"0"==e.productType?t="小件":"2"==e.productType&&(t="单品"),t}},components:{QrCode:L.default,CommonTable:f.a,TemplateCreate:v.default,TemplateImport:b.default,TemplateSelect:g.default}},M=r("Gn17"),R=r.n(M);var U=function(e){r("Js8z")},D=r("C7Lr")(x,R.a,!1,U,"data-v-0611b5a4",null);t.default=D.exports},nyQV:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("rVsN"),o=r.n(a),i=r("HzJ8"),s=r.n(i),n=r("4YfN"),l=r.n(n),c=r("0+j4"),d=r("aIe1"),u=r("Jky9"),h=r("TGOP"),p=r("g9Ix"),m=r("T2UM"),f=r("afXj"),v=r("ryJa"),b=r.n(v),g=r("fBur"),w=(r("KWYu"),r("Ips9")),I=(r("I8tE"),r("4+6g")),y={name:"EntryManger",mixins:[r("dF+P").a],data:function(){return{warehouseList:this.$store.getters.warehouseList,merchantsList:[],brandList:[],modelBrand:[],modelList:[],tableData:[],selectRow:[],selectedOrderInfo:{},isListLoading:!1,pagination:{pageNum:1,pageSize:10,total:0},searchParams:{},isCreateFormVisible:!1,openType:1,isCheckFormVisible:!1,checkInfo:{},isDetailFormVisible:!1,searchMerchantsList:[],flag:2}},mounted:function(){var e={warehouseUuid:Object(g.b)("warehouseUuid")};this.getMerchantsList(e),this.getSearchMerchantsList(e),this.getBrandModel(e)},computed:{isButtonIsDisabled:function(){var e=this;if(this.flag=2,this.selectRow.length)try{this.selectRow.forEach(function(t){if("2"==t.goodsReceviceAuditing)throw e.flag=1,new Error("selectErr");e.flag=0})}catch(e){if("selectErr"!=e.message)throw e}else this.flag=2;return 0!=this.flag}},methods:{queryList:function(e){var t=this.searchParams=e;this.getMerchantsList({warehouseUuid:t.warehouseUuid}),this.getOrders(l()({},t,{pageNum:this.pagination.pageNum,pageSize:this.pagination.pageSize}))},rest:function(e){var t=this.searchParams=e;this.getOrders(l()({},t,{pageNum:this.pagination.pageNum,pageSize:this.pagination.pageSize}))},changePage:function(e){this.pagination.pageNum=e,this.queryList(this.searchParams)},indexMethod:function(e){return e+1+(this.pagination.pageNum-1)*this.pagination.pageSize},resetPage:function(){this.pagination={pageNum:1,pageSize:10,total:0}},updateTable:function(){this.queryList(this.searchParams)},formatState:function(e){switch(e.goodsReceviceAuditing){case"0":return"待提交";case"1":return"待审核";case"2":return"审核通过";case"3":return"审核未通过";case"4":return"完成收货";default:return"未知"}},formatWarehouse:function(e){if(e.goodsWarehouseUuid){var t=this.warehouseList.find(function(t){return t.warehouseUuid===e.goodsWarehouseUuid});if(t)return t.warehouseName}},getOrders:function(e){var t=this;this.isListLoading=!0,Object(w.l)(e).then(function(r){if(0==r.item.length&&r.pageNum>1)return t.pagination.pageNum=1,e.pageNum=1,void t.getOrders(e);t.tableData=r.item;var a=!0,o=!1,i=void 0;try{for(var n,l=s()(t.tableData);!(a=(n=l.next()).done);a=!0){var c=n.value;c.goodsReceiveDate=b()(c.goodsReceiveDate).utcOffset(8).format("YYYY-MM-DD")}}catch(e){o=!0,i=e}finally{try{!a&&l.return&&l.return()}finally{if(o)throw i}}t.pagination.total=r.total,t.pagination.pageNum=r.pageNum,t.pagination.pageSize=r.pageSize,t.isListLoading=!1})},getMerchantsList:function(e){var t=this;return new o.a(function(r){Object(I.f)(e).then(function(e){e.error||(t.merchantsList=e,r())})})},getSearchMerchantsList:function(e){var t=this;Object(I.f)(e).then(function(e){t.searchMerchantsList=e})},getBrandModel:function(e){var t=this;Object(I.h)(e).then(function(e){e.error||(t.brandList=[],t.modelList=[],e.forEach(function(e,r){t.brandList.push(e.productBrand),e.productModel.forEach(function(e){t.modelList.push(e)})}),t.modelBrand=e)})},handleAdd:function(){this.isCreateFormVisible=!0,this.openType=1},handleDel:function(){var e=this;this.$confirm("确认删除选中的收货单吗?","提示",{type:"warning"}).then(function(){var t={orderAccount:[]},r=!0,a=!1,o=void 0;try{for(var i,n=s()(e.selectRow);!(r=(i=n.next()).done);r=!0){var l=i.value;t.orderAccount.push(l.goodsReceiveUuid)}}catch(e){a=!0,o=e}finally{try{!r&&n.return&&n.return()}finally{if(a)throw o}}Object(w.f)(t).then(function(t){t.error||(e.$message({message:"删除成功",type:"success"}),e.queryList(e.searchParams))})}).catch(function(){})},handleScan:function(e){this.isDetailFormVisible=!0,this.selectedOrderInfo=e},handleEdit:function(e){this.isCreateFormVisible=!0,this.openType=3,this.selectedOrderInfo=e},showCheck:function(e){return"0"===e.goodsReceviceAuditing||"1"===e.goodsReceviceAuditing||"3"===e.goodsReceviceAuditing},showEdit:function(e){return"2"!==e.goodsReceviceAuditing},check:function(e){var t=this;if("0"===e.goodsReceviceAuditing||"3"===e.goodsReceviceAuditing){var r={orderAccount:[e.goodsReceiveUuid],checkStatus:1};this.$confirm("确认将该收货单提交审核吗?","提示",{type:"info"}).then(function(){Object(w.c)(r).then(function(e){e.error||(t.$message({message:"收货单已提交审核",type:"success"}),t.queryList(t.searchParams))})}).catch(function(){})}else"1"===e.goodsReceviceAuditing&&(this.isCheckFormVisible=!0,this.checkInfo=e)}},components:{CommonWrapper:c.a,CommonTable:d.a,NavButton:u.a,EntryManagementSearch:h.default,OrderCreate:p.default,EnsureCheck:f.default,OrderDetail:m.default}},_=r("vZra"),L=r.n(_);var k=function(e){r("B64f")},x=r("C7Lr")(y,L.a,!1,k,"data-v-59ee1485",null);t.default=x.exports},to5v:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-dialog",{attrs:{width:"95%",title:"查看收货单",visible:e.isVisible,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.isVisible=t},close:e.cancel}},[r("el-form",{ref:"orderInfo",attrs:{inline:"",model:e.orderInfo}},[r("el-row",[r("el-col",{attrs:{span:6}},[r("el-form-item",{attrs:{label:"商户:","label-width":"60px"}},[r("span",[e._v(e._s(e.orderInfo.goodsReceiveMerchant))])])],1),e._v(" "),r("el-col",{attrs:{span:7}},[r("el-form-item",{attrs:{label:"送达时间:","label-width":"100px"}},[r("span",[e._v(e._s(e.formatTime(e.orderInfo.goodsReceiveDate)))])])],1),e._v(" "),r("el-col",{attrs:{span:6}},[r("el-form-item",{attrs:{label:"备注:","label-width":"60px"}},[r("span",[e._v(e._s(e.orderInfo.goodsReceiveRemark))])])],1),e._v(" "),r("el-col",{staticClass:"text-r",attrs:{span:5}},[r("el-button",{attrs:{type:"primary",disabled:!1},on:{click:e.printCode}},[e._v("打印条码")])],1)],1),e._v(" "),r("el-row",[r("div",[r("common-table",[r("template",{slot:"table"},[r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.isListLoading,expression:"isListLoading"}],ref:"orderTable",attrs:{"max-height":"400",stripe:"",border:!0,"tooltip-effect":"light",data:e.tableData}},[r("el-table-column",{attrs:{type:"index",label:"序号",width:"50"}}),e._v(" "),r("el-table-column",{attrs:{prop:"productBrand",label:"品牌","show-overflow-tooltip":!0}}),e._v(" "),r("el-table-column",{attrs:{prop:"productModel",label:"型号","show-overflow-tooltip":!0}}),e._v(" "),r("el-table-column",{attrs:{prop:"productName",label:"货品名称","show-overflow-tooltip":!0}}),e._v(" "),r("el-table-column",{attrs:{prop:"productStandard",label:"规格","show-overflow-tooltip":!0}}),e._v(" "),r("el-table-column",{attrs:{prop:"productColor",label:"颜色"}}),e._v(" "),r("el-table-column",{attrs:{prop:"receiveItemPack",label:"包装形式",formatter:e.PackFormatter}}),e._v(" "),r("el-table-column",{attrs:{prop:"productType",label:"货品类型",formatter:e.typeFormatter}}),e._v(" "),r("el-table-column",{attrs:{prop:"productItemUuid",label:"子件",formatter:e.itemFormatter,"show-overflow-tooltip":!0}}),e._v(" "),r("el-table-column",{attrs:{prop:"receiveItemCount",label:"数量"}}),e._v(" "),r("el-table-column",{attrs:{prop:"receiveItemRemark",label:"备注",width:"150","show-overflow-tooltip":!0}}),e._v(" "),r("el-table-column",{attrs:{label:"操作",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{disabled:"2"==e.orderInfo.goodsReceviceAuditing,type:"text",rules:"small"},nativeOn:{click:function(r){return r.preventDefault(),e.addCode(t.row,t.$index)}}},[e._v("\n                      条码补打\n                    ")])]}}])})],1)],1)],2)],1)])],1)],1),e._v(" "),r("qr-code",{attrs:{show:e.qrCodeVisible,paramsList:e.paramsList,tableData:e.tableData},on:{"update:show":function(t){e.qrCodeVisible=t}}})],1)},staticRenderFns:[]}},vZra:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("common-wrapper",[r("entry-management-search",{staticClass:"search",attrs:{warehouseList:e.warehouseList,merchantsList:e.searchMerchantsList,brandList:e.brandList},on:{getMerchants:e.getSearchMerchantsList,getBrandModel:e.getBrandModel,resetPage:e.resetPage,search:e.queryList,rest:e.rest}})],1),e._v(" "),r("nav-button",[r("el-button-group",[r("el-button",{attrs:{icon:"fdddfont icon-add-new"},on:{click:e.handleAdd}},[e._v("新增")]),e._v(" "),r("el-button",{attrs:{icon:"el-icon-delete",disabled:e.isButtonIsDisabled},on:{click:e.handleDel}},[e._v("删除")]),e._v(" "),1==e.flag?r("el-alert",{staticStyle:{display:"inline",height:"29px","line-height":"29px","margin-left":"10px"},attrs:{closable:!1,title:"选中项包含审核已通过的收货单，请重新选择！",type:"warning","show-icon":""}}):e._e()],1)],1),e._v(" "),r("common-wrapper",[r("common-table",{attrs:{flex:270}},[r("template",{slot:"table"},[r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.isListLoading,expression:"isListLoading"}],ref:"orderTable",attrs:{height:"100%",stripe:"",border:!0,"tooltip-effect":"light",data:e.tableData},on:{"selection-change":function(t){return e.selectRow=t}}},[r("el-table-column",{attrs:{type:"selection",width:"30"}}),e._v(" "),r("el-table-column",{attrs:{type:"index",index:e.indexMethod,label:"序号",width:"50"}}),e._v(" "),r("el-table-column",{attrs:{sortable:"",prop:"goodsReceiveUuid",label:"收货单号","min-width":"150"}}),e._v(" "),r("el-table-column",{attrs:{sortable:"",prop:"goodsReceiveMerchant",label:"商户"}}),e._v(" "),r("el-table-column",{attrs:{sortable:"",prop:"goodsReceiveDate",label:"送达日期","min-width":"120"}}),e._v(" "),r("el-table-column",{attrs:{prop:"goodsReceviceAuditing",label:"状态",formatter:e.formatState}}),e._v(" "),r("el-table-column",{attrs:{sortable:"",prop:"goodsWarehouseUuid",label:"仓库",formatter:e.formatWarehouse}}),e._v(" "),r("el-table-column",{attrs:{prop:"goodsReceiveRemark",label:"备注","min-width":"150","show-overflow-tooltip":!0}}),e._v(" "),r("el-table-column",{attrs:{label:"操作",width:"190"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tooltip",{staticClass:"item",attrs:{effect:"light",content:"查看",placement:"bottom"}},[r("el-button",{attrs:{size:"mini",round:"",icon:"el-icon-view"},on:{click:function(r){return r.stopPropagation(),e.handleScan(t.row)}}})],1),e._v(" "),r("el-tooltip",{staticClass:"item",attrs:{effect:"light",content:"编辑",placement:"bottom"}},[e.showEdit(t.row)?r("el-button",{attrs:{size:"mini",round:"",icon:"fdddfont icon-modify"},on:{click:function(r){return r.stopPropagation(),e.handleEdit(t.row)}}}):e._e()],1),e._v(" "),r("el-tooltip",{staticClass:"item",attrs:{effect:"light",content:1==t.row.goodsReceviceAuditing?"审核":"提交审核",placement:"bottom"}},[e.showCheck(t.row)?r("el-button",{attrs:{size:"mini",round:"",icon:"el-icon-tickets"},on:{click:function(r){return r.stopPropagation(),e.check(t.row)}}}):e._e()],1)]}}])})],1)],1),e._v(" "),r("template",{slot:"pagination"},[r("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next","current-page":e.pagination.pageNum,"page-size":e.pagination.pageSize,total:e.pagination.total},on:{"update:currentPage":function(t){return e.$set(e.pagination,"pageNum",t)},"update:current-page":function(t){return e.$set(e.pagination,"pageNum",t)},"current-change":e.changePage}})],1)],2)],1),e._v(" "),r("order-create",{attrs:{show:e.isCreateFormVisible,openType:e.openType,selectedOrderInfo:e.selectedOrderInfo,warehouseList:e.warehouseList,merchantsList:e.merchantsList,searchParams:e.searchParams},on:{"update:show":function(t){e.isCreateFormVisible=t},search:e.queryList}}),e._v(" "),r("order-detail",{attrs:{show:e.isDetailFormVisible,selectedOrderInfo:e.selectedOrderInfo,warehouseList:e.warehouseList,merchantsList:e.merchantsList,searchParams:e.searchParams},on:{"update:show":function(t){e.isDetailFormVisible=t},rest:e.rest}}),e._v(" "),r("ensure-check",{attrs:{show:e.isCheckFormVisible,checkInfo:e.checkInfo},on:{"update:show":function(t){e.isCheckFormVisible=t},updateTable:e.updateTable}})],1)},staticRenderFns:[]}},xrZo:function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},ywEJ:function(e,t){}});
//# sourceMappingURL=4.eeea26a1d4069db81ab8.js.map