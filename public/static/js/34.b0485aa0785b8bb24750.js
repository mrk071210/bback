webpackJsonp([34],{"0kfQ":function(e,i){},aQ5O:function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=t("woOf"),o=t.n(s),n=t("Majh"),l=t("Q/su"),a=t("4+6g"),r=Object(n.a)(),c={name:"UploadFile",props:{showUpload:{type:Boolean,default:!1},uploadFileUrl:{type:String},limit:{type:Number,default:1},size:{type:Number,default:.5},acceptType:{type:String,default:".xls"},pojo:{type:[String,Number,Object]},isShowDown:{type:Boolean,default:!1},isHasToken:{type:Boolean,default:!1}},watch:{showUpload:function(e){this.isVisible=e}},data:function(){return{isVisible:!1,isonChange:!0,isSuccess:!0,isDown:!1,myHeaders:{Authorization:r},uploadActionUrl:l.a+this.uploadFileUrl,fileList:[],uploadData:{pojo:this.pojo},limitNum:this.limit,fileSize:this.size,fileType:this.acceptType,exportsParams:{}}},computed:{},methods:{submitUpload:function(){this.$refs.upload.submit()},cancel:function(){this.$emit("update:showUpload",!1),this.isVisible=!1,this.fileList=[],this.isDown=!1,this.isSuccess=!0},complete:function(){this.$emit("complete",o()({},this.exportsParams)),this.cancel()},downFile:function(){Object(a.a)({pojo:this.pojo}).then(function(e){e.url&&(window.location.href=e.url)})},distinct:function(e){for(var i=0,t=e.length;i<t;i++)for(var s=i+1;s<t;s++)e[i].name===e[s].name&&(e.splice(s,1),t--,s--);return e},onChange:function(e,i){if(this.isonChange){this.isSuccess=!0,this.fileList.find(function(i,t,s){return i.name===e.name})&&(this.$message({message:"此文件已存在！",type:"warning"}),this.fileList=this.distinct(i));var t=this.fileType.split(",");if(t.some(function(i){return"."+e.name.split(".")[1]===i})){this.fileList=i.filter(function(e,i,s){return t.some(function(i){return"."+e.name.split(".")[1]===i})});for(var s=null,o=0;o<this.fileList.length;o++)s+=this.fileList[o].size;s/1024/1024<this.fileSize||this.$message({message:"上传文件大小不能超过 "+this.fileSize+"MB!,请分批上传",type:"error"})}else this.$message({message:"上传模板必须是"+this.fileType+"格式中的一类!",type:"error"}),this.fileList=i.filter(function(e,i,s){return t.some(function(i){return"."+e.name.split(".")[1]===i})});this.isDown=!0}},onBeforeUpload:function(e){},handleExceed:function(e,i){i.length&&this.$message({message:"最多可上传"+this.limitNum+"个文件",type:"warning"})},onRemove:function(e,i){this.fileList=i,this.isDown=!1;for(var t=null,s=0;s<this.fileList.length;s++)t+=this.fileList[s].size;t/1024/1024<this.fileSize||this.$message({message:"上传文件大小不能超过 "+this.fileSize+"MB!,请分批上传",type:"error"})},onSuccess:function(e,i,t){var s=this;this.isonChange=!1,this.isSuccess=!1,this.exportsParams=e,setTimeout(function(){s.isonChange=!0},1e3)},uploadError:function(e,i,t){var s=this;this.isonChange=!1,this.isSuccess=!1,this.$message.error(e),setTimeout(function(){s.isonChange=!0},1e3)}}},u=t("rQq6"),h=t.n(u);var p=function(e){t("0kfQ")},f=t("VU/8")(c,h.a,!1,p,"data-v-36075041",null);i.default=f.exports},rQq6:function(e,i){e.exports={render:function(){var e=this,i=e.$createElement,t=e._self._c||i;return t("div",[t("el-dialog",{attrs:{title:"",visible:e.isVisible,width:"600px","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(i){e.isVisible=i},close:e.cancel}},[t("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{drag:"",multiple:"",accept:e.fileType,headers:e.isHasToken?e.myHeaders:{},action:e.uploadActionUrl,data:e.pojo?e.uploadData:{},"file-list":e.fileList,"auto-upload":!1,"show-file-list":!0,limit:e.limitNum,"on-change":e.onChange,"on-exceed":e.handleExceed,"before-upload":e.onBeforeUpload,"on-remove":e.onRemove,"on-success":e.onSuccess,"on-error":e.uploadError}},[t("i",{staticClass:"el-icon-upload"}),e._v(" "),t("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),t("em",[e._v("点击上传")])]),e._v(" "),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("容量支持:"+e._s(e.fileSize)+"MB( "+e._s(1024*e.fileSize)+"KB ), 文件格式:"+e._s(e.fileType)+", 一次最多可上传:"+e._s(e.limitNum)+"个")])]),e._v(" "),t("h3",{attrs:{slot:"title"},slot:"title"},[t("i",{staticClass:"el-icon-upload"}),e._v("文件上传管理器\n        ")]),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-row",[t("el-col",{directives:[{name:"show",rawName:"v-show",value:e.isShowDown,expression:"isShowDown"}],attrs:{span:14}},[t("el-alert",{attrs:{title:"请先下载需要填写的模板",type:"success","show-icon":"",closable:!1}})],1),e._v(" "),t("el-col",{attrs:{span:10,offset:e.isShowDown?0:14}},[t("el-button",{directives:[{name:"show",rawName:"v-show",value:e.isShowDown,expression:"isShowDown"}],attrs:{type:"success",disabled:this.isDown},on:{click:e.downFile}},[e._v("下载")]),e._v(" "),t("el-button",{attrs:{type:"primary",disabled:!this.fileList.length},on:{click:e.submitUpload}},[e._v("上传")]),e._v(" "),t("el-button",{attrs:{disabled:this.isSuccess},on:{click:e.complete}},[e._v("完成")])],1)],1)],1)],1)],1)},staticRenderFns:[]}}});
//# sourceMappingURL=34.b0485aa0785b8bb24750.js.map