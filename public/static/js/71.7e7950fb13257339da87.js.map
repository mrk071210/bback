{"version":3,"sources":["webpack:///./source/admin/src/views/Development/WarehouseManagement/stockCheck/Components/CheckCreate.vue?d209","webpack:///source/admin/src/views/Development/WarehouseManagement/stockCheck/Components/CheckCreate.vue","webpack:///./source/admin/src/views/Development/WarehouseManagement/stockCheck/Components/CheckCreate.vue"],"names":["module","exports","render","_vm","this","_h","$createElement","_c","_self","attrs","width","title","isCreate","visible","isVisible","close-on-click-modal","close-on-press-escape","on","update:visible","$event","close","cancel","ref","model","checkForm","rules","formRules","label-width","type","justify","span","label","prop","staticClass","placeholder","change","warehouseChange","value","callback","$$v","$set","expression","_l","item","index","key","warehouseName","warehouseUuid","_v","filterable","clearable","merchantsChange","userName","userUuid","align","unlink-panels","size","format","value-format","click","save","empty-text","data","shelvesTreeData","node-key","props","defaultProps","show-checkbox","default-checked-keys","checkedNodes","default-expanded-keys","expandNodes","check","handleCheckNode","staticRenderFns","CheckCreate","name","brand","merchantUuid","beginDate","endDate","shelvesList","required","message","trigger","brandList","modelBrand","merchantsList","show","Boolean","default","warehouseList","Array","merchants","taskInfo","Object","searchParams","watch","isShow","assign_default","getMerchants","getBrandModel","updateTree","methods","_this","promise_default","a","resolve","params","common","then","res","error","_this2","modelList","forEach","push","productBrand","productModel","item2","_this3","_this4","warehouse","generateTree","node","pId","id","storageUuids","storageUuidList","split","needToCheckedNodes","length","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","get_iterator_default","next","done","substring","err","return","$refs","tree","setCheckedKeys","getOnlyChildrenNodes","nodeIds","filter","nodeId","children","getCheckedNodes","_this5","validate","isValid","moment_default","isBefore","isSame","$message","find","submitText","$emit","resetFields","components","CommonWrapper","commonWrapper","VuePerfectScrollbar","dist_default","__vue_styles__","ssrContext","__webpack_require__","Component","normalizeComponent","CheckCreate_default","__webpack_exports__"],"mappings":"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","file":"static/js/71.7e7950fb13257339da87.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-dialog',{attrs:{\"width\":\"600px\",\"title\":(_vm.isCreate ? '新增' : '编辑') + '盘点任务',\"visible\":_vm.isVisible,\"close-on-click-modal\":false,\"close-on-press-escape\":false},on:{\"update:visible\":function($event){_vm.isVisible=$event},\"close\":_vm.cancel}},[_c('el-form',{ref:\"checkForm\",attrs:{\"model\":_vm.checkForm,\"rules\":_vm.formRules,\"label-width\":\"80px\"}},[_c('el-row',{attrs:{\"type\":\"flex\",\"justify\":\"space-between\"}},[_c('el-col',{attrs:{\"span\":12}},[_c('el-row',[_c('el-form-item',{attrs:{\"label\":\"仓库\",\"prop\":\"warehouseUuid\"}},[_c('el-select',{staticClass:\"w100p\",attrs:{\"placeholder\":\"请选择仓库\"},on:{\"change\":_vm.warehouseChange},model:{value:(_vm.checkForm.warehouseUuid),callback:function ($$v) {_vm.$set(_vm.checkForm, \"warehouseUuid\", $$v)},expression:\"checkForm.warehouseUuid\"}},_vm._l((_vm.warehouseList),function(item,index){return _c('el-option',{key:index,attrs:{\"label\":item.warehouseName,\"value\":item.warehouseUuid}})}),1)],1)],1),_vm._v(\" \"),_c('el-row',[_c('el-form-item',{attrs:{\"label\":\"商户\",\"prop\":\"merchants\"}},[_c('el-select',{staticClass:\"w100p\",attrs:{\"filterable\":\"\",\"clearable\":\"\",\"placeholder\":\"请选择商户\"},on:{\"change\":_vm.merchantsChange},model:{value:(_vm.checkForm.merchantUuid),callback:function ($$v) {_vm.$set(_vm.checkForm, \"merchantUuid\", $$v)},expression:\"checkForm.merchantUuid\"}},_vm._l((_vm.merchantsList),function(item,index){return _c('el-option',{key:index,attrs:{\"label\":item.userName,\"value\":item.userUuid}})}),1)],1)],1),_vm._v(\" \"),_c('el-row',[_c('el-form-item',{attrs:{\"label\":\"品牌\",\"prop\":\"brand\"}},[_c('el-select',{staticClass:\"w100p\",attrs:{\"filterable\":\"\",\"clearable\":\"\",\"placeholder\":\"请选择品牌\"},model:{value:(_vm.checkForm.brand),callback:function ($$v) {_vm.$set(_vm.checkForm, \"brand\", $$v)},expression:\"checkForm.brand\"}},_vm._l((_vm.brandList),function(item,index){return _c('el-option',{key:index,staticClass:\"radio\",attrs:{\"value\":item,\"label\":item}})}),1)],1)],1),_vm._v(\" \"),_c('el-row',[_c('el-form-item',{attrs:{\"label\":\"开始日期\",\"prop\":\"beginDate\"}},[_c('el-date-picker',{staticClass:\"w100p\",attrs:{\"placeholder\":\"请选择开始日期\",\"align\":\"right\",\"unlink-panels\":\"\",\"size\":\"mini\",\"format\":\"yyyy 年 MM 月 dd 日\",\"value-format\":\"yyyy-MM-dd\"},model:{value:(_vm.checkForm.beginDate),callback:function ($$v) {_vm.$set(_vm.checkForm, \"beginDate\", $$v)},expression:\"checkForm.beginDate\"}})],1)],1),_vm._v(\" \"),_c('el-row',[_c('el-form-item',{attrs:{\"label\":\"截止日期\",\"prop\":\"endDate\"}},[_c('el-date-picker',{staticClass:\"w100p\",attrs:{\"placeholder\":\"请选择截止日期\",\"align\":\"right\",\"unlink-panels\":\"\",\"size\":\"mini\",\"format\":\"yyyy 年 MM 月 dd 日\",\"value-format\":\"yyyy-MM-dd\"},model:{value:(_vm.checkForm.endDate),callback:function ($$v) {_vm.$set(_vm.checkForm, \"endDate\", $$v)},expression:\"checkForm.endDate\"}})],1)],1),_vm._v(\" \"),_c('el-row',{staticClass:\"text-c\"},[_c('el-col',[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.save}},[_vm._v(\"保存\")]),_vm._v(\" \"),_c('el-button',{on:{\"click\":_vm.cancel}},[_vm._v(\"取消\")])],1)],1)],1),_vm._v(\" \"),_c('el-col',{attrs:{\"span\":11}},[_c('common-wrapper',{staticClass:\"treeArea\"},[_c('VuePerfectScrollbar',{staticClass:\"scroll-area\"},[_c('el-tree',{ref:\"tree\",attrs:{\"empty-text\":\"请选择需要盘点仓库\",\"data\":_vm.shelvesTreeData,\"node-key\":\"id\",\"props\":_vm.defaultProps,\"show-checkbox\":true,\"default-checked-keys\":_vm.checkedNodes,\"default-expanded-keys\":_vm.expandNodes},on:{\"check\":_vm.handleCheckNode}})],1)],1)],1)],1)],1)],1)}\nvar staticRenderFns = []\nmodule.exports = { render: render, staticRenderFns: staticRenderFns }\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler?{\"id\":\"data-v-74706b34\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@13.7.3@vue-loader/lib/selector.js?type=template&index=0!./source/admin/src/views/Development/WarehouseManagement/stockCheck/Components/CheckCreate.vue\n// module id = /DMk\n// module chunks = 16 71","<template>\r\n  <el-dialog\r\n    width=\"600px\"\r\n    :title=\"(isCreate ? '新增' : '编辑') + '盘点任务'\"\r\n    :visible.sync=\"isVisible\"\r\n    :close-on-click-modal=\"false\"\r\n    :close-on-press-escape=\"false\"\r\n    @close=\"cancel\"\r\n  >\r\n    <el-form ref=\"checkForm\" :model=\"checkForm\" :rules=\"formRules\" label-width=\"80px\">\r\n      <el-row type=\"flex\" justify=\"space-between\">\r\n        <el-col :span=\"12\">\r\n          <el-row>\r\n            <el-form-item label=\"仓库\" prop=\"warehouseUuid\">\r\n              <el-select placeholder=\"请选择仓库\" class=\"w100p\" v-model=\"checkForm.warehouseUuid\"\r\n                         @change=\"warehouseChange\">\r\n                <el-option\r\n                  v-for=\"(item, index) in warehouseList\"\r\n                  :key=\"index\"\r\n                  :label=\"item.warehouseName\"\r\n                  :value=\"item.warehouseUuid\"/>\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-row>\r\n          <el-row>\r\n            <el-form-item label=\"商户\" prop=\"merchants\">\r\n              <el-select v-model=\"checkForm.merchantUuid\" filterable clearable placeholder=\"请选择商户\" class=\"w100p\"\r\n                         @change=\"merchantsChange\">\r\n                <el-option\r\n                  v-for=\"(item, index) in merchantsList\"\r\n                  :key=\"index\"\r\n                  :label=\"item.userName\"\r\n                  :value=\"item.userUuid\"/>\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-row>\r\n          <el-row>\r\n            <el-form-item label=\"品牌\" prop=\"brand\">\r\n              <el-select v-model=\"checkForm.brand\" filterable clearable placeholder=\"请选择品牌\" class=\"w100p\">\r\n                <el-option\r\n                v-for=\"(item,index) in brandList\"\r\n                :key=\"index\" class=\"radio\"\r\n                :value=\"item\"\r\n                :label=\"item\" />\r\n                </el-select>\r\n            </el-form-item>\r\n          </el-row>\r\n          <!--<el-row>-->\r\n            <!--<el-form-item label=\"型号\" prop=\"model\">-->\r\n              <!--<el-select v-model=\"checkForm.model\" clearable placeholder=\"请选择型号\" class=\"w100p\" @change=\"modelChange\">-->\r\n                <!--<el-option-->\r\n                <!--v-for=\"(item, index) in modelList\"-->\r\n                <!--:key=\"index\"-->\r\n                <!--:label=\"item\"-->\r\n                <!--:value=\"item\" />-->\r\n              <!--</el-select>-->\r\n            <!--</el-form-item>-->\r\n          <!--</el-row>-->\r\n          <el-row>\r\n            <el-form-item label=\"开始日期\" prop=\"beginDate\">\r\n              <el-date-picker\r\n                class=\"w100p\"\r\n                placeholder=\"请选择开始日期\"\r\n                v-model=\"checkForm.beginDate\"\r\n                align=\"right\"\r\n                unlink-panels\r\n                size=\"mini\"\r\n                format=\"yyyy 年 MM 月 dd 日\"\r\n                value-format=\"yyyy-MM-dd\">\r\n              </el-date-picker>\r\n            </el-form-item>\r\n          </el-row>\r\n          <el-row>\r\n            <el-form-item label=\"截止日期\" prop=\"endDate\">\r\n              <el-date-picker\r\n                class=\"w100p\"\r\n                placeholder=\"请选择截止日期\"\r\n                v-model=\"checkForm.endDate\"\r\n                align=\"right\"\r\n                unlink-panels\r\n                size=\"mini\"\r\n                format=\"yyyy 年 MM 月 dd 日\"\r\n                value-format=\"yyyy-MM-dd\">\r\n              </el-date-picker>\r\n            </el-form-item>\r\n          </el-row>\r\n          <el-row class=\"text-c\">\r\n            <el-col>\r\n              <el-button type=\"primary\" @click=\"save\">保存</el-button>\r\n              <el-button @click=\"cancel\">取消</el-button>\r\n            </el-col>\r\n          </el-row>\r\n        </el-col>\r\n        <el-col :span=\"11\">\r\n          <common-wrapper class=\"treeArea\">\r\n            <VuePerfectScrollbar class=\"scroll-area\">\r\n              <el-tree\r\n                ref=\"tree\"\r\n                empty-text=\"请选择需要盘点仓库\"\r\n                :data=\"shelvesTreeData\"\r\n                node-key=\"id\"\r\n                :props=\"defaultProps\"\r\n                :show-checkbox=\"true\"\r\n                :default-checked-keys=\"checkedNodes\"\r\n                :default-expanded-keys=\"expandNodes\"\r\n                @check=\"handleCheckNode\"\r\n              ></el-tree>\r\n            </VuePerfectScrollbar>\r\n          </common-wrapper>\r\n        </el-col>\r\n      </el-row>\r\n    </el-form>\r\n  </el-dialog>\r\n</template>\r\n<script>\r\n  /**\r\n   * StockCheck  Module\r\n   * ----------------------\r\n   * Author: Calamus\r\n   * Date: 2018.09.05\r\n   */\r\n  // validate\r\n  import moment from 'moment'\r\n  import VuePerfectScrollbar from 'vue-perfect-scrollbar'\r\n  import {setSession, getSession} from '@/utils/session'\r\n\r\n  import Validator from '@/utils/extendValidate/extendValidate'\r\n  import CommonWrapper from '@/components/commonWrapper'\r\n  import {generateTree} from '@/utils/generateTree'\r\n  import {getShelvesWithCondition, stockCheckedAdd} from '@/api/warehouse'\r\n  import {getAllMerchantsList, getBrandModel } from '@/api/common'\r\n\r\n  export default {\r\n    name: 'StockCheckCreat',\r\n    data () {\r\n      return {\r\n        isVisible: false,\r\n        checkForm: {\r\n          brand:'',\r\n          merchantUuid:'',\r\n          warehouseUuid:'',\r\n          beginDate:'',\r\n          endDate:'',\r\n          shelvesList:[]\r\n        },\r\n        formRules: {\r\n          warehouseUuid: [{required: true, message: '请选择仓库', trigger: 'blur'}],\r\n          beginDate: [{required: true, message: '请选择开始日期', trigger: 'blur'}],\r\n          endDate: [{required: true, message: '请选择截止日期', trigger: 'blur'}],\r\n        },\r\n        defaultProps: {\r\n          label: 'name'\r\n        },\r\n        brandList: [],\r\n        modelBrand: [],\r\n        merchantsList: [],\r\n        shelvesTreeData: [],\r\n        checkedNodes: [],\r\n        expandNodes: []\r\n      }\r\n    },\r\n    props: {\r\n      show: {\r\n        type: Boolean,\r\n        default: false\r\n      },\r\n      isCreate: {\r\n        type: Boolean,\r\n        default: true\r\n      },\r\n      warehouseList: {\r\n        type: Array,\r\n        required: true\r\n      },\r\n      merchants: {\r\n        type: Array,\r\n        default: () => []\r\n      },\r\n      taskInfo: {\r\n        type: Object\r\n      },\r\n      searchParams: {\r\n        type: Object\r\n      }\r\n    },\r\n    watch: {\r\n      show (isShow) {\r\n        this.isVisible = isShow\r\n        if (!this.isCreate && this.isVisible) {\r\n          this.checkForm = Object.assign({}, this.taskInfo)\r\n          this.getMerchants()\r\n          this.getBrandModel({warehouseUuid: this.checkForm.warehouseUuid})\r\n          this.updateTree()\r\n        }\r\n      },\r\n    },\r\n    methods: {\r\n      // 获取商户\r\n      getMerchants () {\r\n        return new Promise(resolve => {\r\n          let params = {warehouseUuid: this.checkForm.warehouseUuid}\r\n          getAllMerchantsList(params).then(res => {\r\n            if (!res.error) {\r\n              this.merchantsList = res\r\n              resolve()\r\n            }\r\n          })\r\n        })\r\n      },\r\n      // 获取品牌型号列表\r\n      getBrandModel (params) {\r\n        getBrandModel(params).then(res => {\r\n          if (!res.error) {\r\n            this.brandList = []\r\n            this.modelList = []\r\n            res.forEach((item,index) => {\r\n              this.brandList.push(item.productBrand)\r\n              item.productModel.forEach(item2 => {\r\n                this.modelList.push(item2)\r\n              })\r\n            })\r\n            this.modelBrand = res\r\n          }\r\n        })\r\n      },\r\n      // 仓库改变\r\n      warehouseChange () {\r\n        this.getBrandModel({warehouseUuid: this.checkForm.warehouseUuid})\r\n        this.getMerchants().then(() => {\r\n          this.checkForm.merchantUuid = ''\r\n          this.checkForm.brand = ''\r\n          this.updateTree()\r\n        })\r\n      },\r\n      // 商户改变\r\n      merchantsChange (value) {\r\n          this.checkForm.brand = ''\r\n          this.getBrandModel({warehouseUuid: this.checkForm.warehouseUuid,merchantUuid:value})\r\n          this.updateTree()\r\n      },\r\n      updateTree () {\r\n        this.checkForm.shelvesList = []\r\n        this.checkedNodes = []\r\n        this.expandNodes = []\r\n        getShelvesWithCondition(this.checkForm).then(res => {\r\n          this.shelvesTreeData = generateTree(res)\r\n          res.forEach(node => {\r\n            if (node.pId === '') this.expandNodes.push(node.id)\r\n          })\r\n          if (!this.isCreate && this.taskInfo.storageUuids) {\r\n            let storageUuidList = this.taskInfo.storageUuids.split(',')\r\n            let needToCheckedNodes = []\r\n            if (storageUuidList.length) {\r\n              for (let item of storageUuidList) {\r\n                item = item.substring(1, item.length - 1)\r\n                needToCheckedNodes.push(item)\r\n              }\r\n              this.$refs.tree.setCheckedKeys(needToCheckedNodes)\r\n            }\r\n          }\r\n        })\r\n      },\r\n      getOnlyChildrenNodes (nodeIds) {\r\n        return nodeIds.filter(nodeId => !nodeId.children.length)\r\n      },\r\n      handleCheckNode () {\r\n        const checkedNodes = this.$refs.tree.getCheckedNodes()\r\n        // const halfCheckedNodes = this.$refs.tree.getHalfCheckedKeys()\r\n        // const allCheckedNodes = checkedNodes.concat(halfCheckedNodes)\r\n        this.checkForm.shelvesList = checkedNodes\r\n      },\r\n      save () {\r\n        this.$refs.checkForm.validate(isValid => {\r\n          if (isValid) {\r\n            if (this.checkForm.endDate && this.checkForm.beginDate &&  ( moment(this.checkForm.endDate).isBefore(this.checkForm.beginDate) || moment(this.checkForm.endDate).isSame(this.checkForm.beginDate))) {\r\n              this.$message({\r\n                message: '截止日期不能早于开始日期！',\r\n                type: 'warning'\r\n              })\r\n              return\r\n            } else {\r\n              this.handleCheckNode()\r\n              if (this.checkForm.shelvesList.length) {\r\n                this.checkForm.warehouseName = this.warehouseList.find(item => item.warehouseUuid === this.checkForm.warehouseUuid).warehouseName\r\n                stockCheckedAdd(this.checkForm).then(res => {\r\n                  if (!res.error) {\r\n                    const submitText = this.isCreate ? '新增' : '编辑'\r\n                    this.$message({\r\n                      message: `${submitText}盘点成功!`,\r\n                      type: 'success'\r\n                    })\r\n                    this.cancel()\r\n                    this.$emit('updateList', this.searchParams)\r\n                  }\r\n                })\r\n              } else {\r\n                this.$message({\r\n                  message: `请选择要盘点的库位!`,\r\n                  type: 'warning'\r\n                })\r\n              }\r\n            }\r\n          }\r\n        })\r\n      },\r\n      cancel () {\r\n        this.shelvesTreeData = []\r\n        this.checkForm = {}\r\n        this.$refs.checkForm.resetFields()\r\n        this.$emit('update:show', false)\r\n        this.isVisible = false\r\n      }\r\n    },\r\n    components: {\r\n      CommonWrapper,\r\n      VuePerfectScrollbar\r\n    }\r\n  }\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n  .treeArea {\r\n    margin-top: 0;\r\n    .scroll-area {\r\n      height: 350px;\r\n    }\r\n  }\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// source/admin/src/views/Development/WarehouseManagement/stockCheck/Components/CheckCreate.vue","function injectStyle (ssrContext) {\n  require(\"!!../../../../../../../../node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../../../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-74706b34\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader!sass-resources-loader?{\\\"resources\\\":[\\\"D:\\\\\\\\workspace\\\\\\\\wms_web\\\\\\\\source\\\\\\\\admin\\\\\\\\src\\\\\\\\common\\\\\\\\style\\\\\\\\common.scss\\\"]}!../../../../../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=styles&index=0!./CheckCreate.vue\")\n}\nvar normalizeComponent = require(\"!../../../../../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./CheckCreate.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./CheckCreate.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-74706b34\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=template&index=0!./CheckCreate.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-74706b34\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./source/admin/src/views/Development/WarehouseManagement/stockCheck/Components/CheckCreate.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}